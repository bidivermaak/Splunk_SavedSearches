
# verified
[The event logging service has shut down.]
search = sourcetype=WinEventLog:Security EventCode=1100 
| rex field=Message "(?<summary>.*)"
| table _time host sourcetype EventCode summary

# verified
[Audit events have been dropped by the transport.]
search = sourcetype=WinEventLog:Security EventCode=1101 
| rex field=Message "(?<summary>.*)"
| table _time host sourcetype EventCode summary

# verified
[Windows is starting up.]
search = sourcetype=WinEventLog:Security EventCode=4608 
| rex field=Message "(?<summary>.*)"
| table _time host sourcetype EventCode summary

# verified
[The system time was changed.]
search = sourcetype=WinEventLog:Security EventCode=4616 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Process Information:\s+Process ID:\s+(?<ProcessInfo_Process_ID>.*)\s+Name:\s+(?<ProcessInfo_Name>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, ProcessInfo_Process_ID, ProcessInfo_Name

# verified -- but need to add support for win10.
[An account was successfully logged on.]
search = sourcetype=WinEventLog:Security EventCode=4624 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)" 
| rex field=Message "Logon Type:\s+(?<Logon_Info_Logon_Type>.*)" 
| rex field=Message "Impersonation Level:\s+(?<Impersonation_Level>.*)" 
| rex field=Message "New Logon:\s+Security ID:\s+(?<New_Logon_Security_ID>.*)\s+Account Name:\s+(?<New_Logon_Account_Name>.*)\s+Account Domain:\s+(?<New_Logon_Account_Domain>.*)\s+Logon ID:\s+(?<New_Logon_Logon_ID>.*)\s+Logon GUID:\s+(?<New_Logon_Logon_GUID>.*)" 
| rex field=Message "Process Information:\s+Process ID:\s+(?<ProcessInfo_Process_ID>.*)\s+Process Name:\s+(?<ProcessInfo_Process_Name>.*)" 
| rex field=Message "Network Information:\s+Workstation Name:\s+(?<NetInfo_Workstation_Name>.*)\s+Source Network Address:\s+(?<NetInfo_Source_Net_Address>.*)\s+Source Port:\s+(?<NetInfo_Source_Port>.*)" 
| rex field=Message "Detailed Authentication Information:\s+Logon Process:\s+(?<DetailedAuth_Logon_Process>.*)\s+Authentication Package:\s+(?<DetailedAuth_Package>.*)\s+Transited Services:\s+(?<DetailedAuth_Transited_Svcs>.*)\s+Package Name \(NTLM only\):\s+(?<DetailedAuth_PkgName>.*)\s+Key Length:\s+(?<DetailedAuth_KeyLength>.*)" 
| table _time host sourcetype EventCode summary Subject_Security_ID Subject_Account_Name Subject_Account_Domain Subject_Logon_ID Logon_Info_Logon_Type Logon_Info_Restricted_Admin_Mode Logon_Info_Virtual_Account Logon_Info_Elevated_Token Impersonation_Level New_Logon_Security_ID New_Logon_Account_Name New_Logon_Account_Domain New_Logon_Logon_ID New_Logon_Linked_Logon_ID New_Logon_Network_Account_Name New_Logon_Network_Account_Domain New_Logon_Logon_GUID ProcessInfo_Process_ID ProcessInfo_Process_Name NetInfo_Workstation_Name NetInfo_Source_Net_Address NetInfo_Source_Port DetailedAuth_Logon_Process DetailedAuth_Transited_Svcs DetailedAuth_PkgName DetailedAuth_KeyLength

# verified
[Failed Attempt to Login to a Disabled Account]
search = sourcetype="WinEventLog:security" EventCode=4625 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)" 
| rex field=Message "Logon Type:\s+(?<Logon_Info_Logon_Type>.*)" 
| rex field=Message "Account For Which Logon Failed:\s+Security ID:\s+(?<Acct_Failed_Security_ID>.*)\s+Account Name:\s+(?<Acct_Failed_Acct_Name>.*)\s+Account Domain:\s+(?<Acct_Failed_Acct_Domain>.*)" 
| rex field=Message "Failure Information:\s+Failure Reason:\s+(?<Failure_Info_Reason>.*)\s+Status:\s+(?<Failure_Info_Status>.*)\s+Sub Status:\s+(?<Failure_Info_SubStatus>.*)" 
| rex field=Message "Process Information:\s+Caller Process ID:\s+(?<ProcessInfo_Process_ID>.*)\s+Caller Process Name:\s+(?<ProcessInfo_Process_Name>.*)" 
| rex field=Message "Network Information:\s+Workstation Name:\s+(?<NetInfo_Workstation_Name>.*)\s+Source Network Address:\s+(?<NetInfo_Source_Net_Address>.*)\s+Source Port:\s+(?<NetInfo_Source_Port>.*)" 
| rex field=Message "Detailed Authentication Information:\s+Logon Process:\s+(?<DetailedAuth_Logon_Process>.*)\s+Authentication Package:\s+(?<DetailedAuth_Package>.*)\s+Transited Services:\s+(?<DetailedAuth_Transited_Svcs>.*)\s+Package Name \(NTLM only\):\s+(?<DetailedAuth_PkgName>.*)\s+Key Length:\s+(?<DetailedAuth_KeyLength>.*)" 
| table _time host sourcetype EventCode summary Subject_Security_ID Subject_Account_Name Subject_Account_Domain Subject_Logon_ID Logon_Info_Logon_Type Acct_Failed_Security_ID Acct_Failed_Acct_Name Acct_Failed_Acct_Domain Failure_Info_Reason Failure_Info_Status Failure_Info_SubStatus ProcessInfo_Process_ID ProcessInfo_Process_Name NetInfo_Workstation_Name NetInfo_Source_Net_Address NetInfo_Source_Port DetailedAuth_Logon_Process DetailedAuth_Transited_Svcs DetailedAuth_PkgName DetailedAuth_KeyLength

# Verified
[An account was logged off.]
search = sourcetype=WinEventLog:Security EventCode=4634 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Logon Type:\s+(?<Logon_Type>\d+)"
| eval Logon_Type_Desc = case(Logon_Type==2,"Interactive",Logon_Type==3,"Network",Logon_Type==4,"Batch",Logon_Type==5,"Service",Logon_Type==7,"Unlock",Logon_Type==8,"NetworkCleartext",Logon_Type_Desc==9,"NewCredentials",Logon_Type==10,"RemoteInteractive",Logon_Type==11,"CachedInteractive",1==1,"Unknown")
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, Logon_Type Logon_Type_Desc

# Verified
[User initiated logoff:]
search = sourcetype=WinEventLog:Security EventCode=4647 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID

# Verified
[A logon was attempted using explicit credentials.]
search = sourcetype=WinEventLog:Security EventCode=4648 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)\s+Logon GUID:\s+(?<Subject_Logon_GUID>.*)" 
| rex field=Message "Account Whose Credentials Were Used:\s+Account Name:\s+(?<AcctCredsUsed_Account_Name>.*)\s+Account Domain:\s+(?<AcctCredsUsed_Account_Domain>.*)\s+Logon GUID:\s+(?<AcctCredsUsed_Logon_GUID>.*)" 
| rex field=Message "Target Server:\s+Target Server Name:\s+(?<Target_Server_Target_Server_Name>.*)\s+Additional Information:\s+(?<Target_Server_AdditionalInfo>.*)" 
| rex field=Message "Network Information:\s+Network Address:\s+(?<NetInfo_Net_Address>.*)\s+Port:\s+(?<NetInfo_Port>.*)" 
| table _time host sourcetype EventCode summary Subject_Security_ID Subject_Account_Name Subject_Account_Domain Subject_Logon_ID Subject_Logon_GUID AcctCredsUsed_Account_Name AcctCredsUsed_Account_Domain AcctCredsUsed_Logon_GUID Target_Server_Target_Server_Name Target_Server_AdditionalInfo NetInfo_Net_Address NetInfo_Port

# Verified
[A handle to an object was requested with intent to delete.]
sourcetype=WinEventLog:Security EventCode=4659 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Object:\s+Object Server:\s+(?<Object_Object_Server>.*)\s+Object Type:\s+(?<Object_Object_Type>.*)\s+Object Name:\s+(?<Object_Object_Name>.*)\s+Handle ID:\s+(?<Object_Handle_ID>.*)" 
| rex field=Message "Process Information:\s+Process ID:\s+(?<ProcessInfo_Process_ID>.*)" 
| rex field=Message "Access Request Information:\s+Transaction ID:\s+(?<AccessReqInfo_Transaction_ID>.*)\s+Accesses:\s+(?<AccessReqInfo_Accesses>.*)\s+Access Mask:\s+(?<AccessReqInfo_Access_Mask>.*)\s+Privileges Used for Access Check:\s+(?<AccessReqInfo_PrivsUsed>.*)" 
| table _time host sourcetype EventCode summary Subject_Security_ID Subject_Account_Name Subject_Account_Domain Subject_Logon_ID Object_Object_Server Object_Object_Type Object_Object_Name Object_Handle_ID ProcessInfo_Process_ID AccessReqInfo_Transaction_ID AccessReqInfo_Accesses AccessReqInfo_Access_Mask

# Verified
[An object was deleted.]
sourcetype=WinEventLog:Security EventCode=4660 
| rex field=Message "(?<summary>.*)"
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Object:\s+Object Server:\s+(?<Object_Object_Server>.*)\s+Handle ID:\s+(?<Object_Handle_ID>.*)"
| rex field=Message "Process Information:\s+Process ID:\s+(?<ProcessInfo_Process_ID>.*)\s+Process Name:\s+(?<ProcessInfo_Process_Name>.*)\s+Transaction ID:\s+(?<ProcessInfo_Transaction_ID>.*)"
| table _time host sourcetype EventCode summary Subject_Security_ID Subject_Account_Name Subject_Account_Domain Subject_Logon_ID Object_Object_Server Object_Handle_ID ProcessInfo_Process_ID ProcessInfo_Process_Name ProcessInfo_Transaction_ID

# Verified
[An attempt was made to access an object.]
sourcetype=WinEventLog:Security EventCode=4663 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Object:\s+Object Server:\s+(?<Object_Object_Server>.*)\s+Object Type:\s+(?<Object_Object_Type>.*)\s+Object Name:\s+(?<Object_Object_Name>.*)\s+Handle ID:\s+(?<Object_Handle_ID>.*)\s+Resource Attributes:\s+(?<Object_Resource_Attributes>.*)" 
| rex field=Message "Process Information:\s+Process ID:\s+(?<ProcessInfo_Process_ID>.*)\s+Process Name:\s+(?<ProcessInfo_Process_Name>.*)" 
| rex field=Message "Access Request Information:\s+Accesses:\s+(?<AccessReqInfo_Accesses>.*)\s+Access Mask:\s+(?<AccessReqInfo_Access_Mask>.*)"
| table _time host sourcetype EventCode summary Subject_Security_ID Subject_Account_Name Subject_Account_Domain Subject_Logon_ID Object_Object_Server Object_Object_Type Object_Object_Name Object_Handle_ID Object_Resource_Attributes ProcessInfo_Process_ID ProcessInfo_Process_Name AccessReqInfo_Accesses AccessReqInfo_Access_Mask

# Verified
[An attempt was made to create a hard link.]
search = sourcetype=WinEventLog:Security EventCode=4664 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Account Name:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)" 
| rex field=Message "Link Information:\s+File Name:\s+(?<Link_Information_File_Name>.*)\s+Link Name:\s+(?<Link_Information_Link_Name>.*)\s+Transaction ID:\s+(?<Link_Information_Transaction_ID>.*)" 
| table _time host sourcetype EventCode summary, Subject_Security_ID Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, Link_Information_File_Name, Link_Information_Link_Name, Link_Information_Transaction_ID

# Verified
[Special privileges assigned to new logon.]
search = sourcetype=WinEventLog:Security EventCode=4672 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Privileges:\s+(?<Privileges>(.|\s)*)"
| table _time host sourcetype EventCode summary Subject_Security_ID Subject_Account_Name Subject_Account_Domain Subject_Logon_ID Privileges

# issue 1, issue 2
[A new process has been created.]
search = sourcetype=WinEventLog:Security EventCode=4688 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Creator Subject:\s+Security ID:\s+(?<Creator_Subject_Security_ID>.*)\s+Account Name:\s+(?<Creator_Subject_Account_Name>.*)\s+Account Domain:\s+(?<Creator_Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Creator_Subject_Logon_ID>.*)"
| rex field=Message "Target Subject:\s+Security ID:\s+(?<Target_Subject_Security_ID>.*)\s+Account Name:\s+(?<Target_Subject_Account_Name>.*)\s+Account Domain:\s+(?<Target_Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Target_Subject_Logon_ID>.*)"
| rex field=Message "Process Information:\s+New Process ID:\s+(?<ProcessInfo_New_Process_ID>.*)\s+New Process Name:\s+(?<ProcessInfo_New_Process_Name>.*)\s+Token Elevation Type:\s+(?<ProcessInfo_Token_Elevation_Type>.*)\s+Creator Process ID:\s+(?<ProcessInfo_Creator_Process_ID>.*)\s+Process Command Line:\s+(?<ProcessInfo_Process_Command_Line>.*)"
| table _time host sourcetype EventCode summary, Creator_Subject_Security_ID, Creator_Subject_Account_Name, Creator_Subject_Account_Domain, Creator_Subject_Logon_ID, Target_Subject_Security_ID, Target_Subject_Account_Name, Target_Subject_Account_Domain, Target_Subject_Logon_ID, ProcessInfo_New_Process_ID, ProcessInfo_New_Process_Name, ProcessInfo_Token_Elevation_Type, ProcessInfo_Creator_Process_ID, ProcessInfo_Process_Command_Line

# Verified
[A member was added to a security-enabled global group]
search = sourcetype=WinEventLog:Security EventCode=4728 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Member:\s+Security ID:\s+(?<Member_Security_ID>.*)\s+Account Name:\s+(?<Member_Account_Account_Name>.*)"
| rex field=Message "Group:\s+Security ID:\s+(?<Group_Security_ID>.*)\s+Group Name:\s+(?<Group_Group_Name>.*)\s+Group Domain:\s+(?<Group_Group_Domain>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, Member_Security_ID Member_Account_Account_Name Group_Security_ID Group_Group_Name Group_Group_Domain

# Verified
[A user account was changed.]
search = sourcetype=WinEventLog:Security EventCode=4738 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Target Account:\s+Security ID:\s+(?<Target_Account_Security_ID>.*)\s+Account Name:\s+(?<Target_Account_Account_Name>.*)\s+Account Domain:\s+(?<Target_Account_Account_Domain>.*)" 
| rex field=Message "Changed Attributes:\s+SAM Account Name:\s+(?<ChangedAttribs_SAM_Account_Name>.*)\s+Display Name:\s+(?<ChangedAttribs_Display_Name>.*)\s+User Principal Name:\s+(?<ChangedAttribs_UPN>.*)\s+Home Directory:\s+(?<ChangedAttribs_Home_Directory>.*)\s+Home Drive:\s+(?<ChangedAttribs_Home_Drive>.*)\s+Script Path:\s+(?<ChangedAttribs_Script_Path>.*)\s+Profile Path:\s+(?<ChangedAttribs_Profile_Path>.*)\s+User Workstations:\s+(?<ChangedAttribs_User_Workstations>.*)\s+Password Last Set:\s+(?<ChangedAttribs_Password_Last_Set>.*)\s+Account Expires:\s+(?<ChangedAttribs_Account_Expires>.*)\s+Primary Group ID:\s+(?<ChangedAttribs_Primary_Group_ID>.*)\s+AllowedToDelegateTo:\s+(?<ChangedAttribs_AllowedDelegateTo>.*)\s+Old UAC Value:\s+(?<ChangedAttribs_Old_UAC_Value>.*)\s+New UAC Value:\s+(?<ChangedAttribs_New_UAC_Value>.*)\s+User Account Control:\s+(?<ChangedAttribs_UserAcctControl>.*)\s+User Parameters:\s+(?<ChangedAttribs_User_Parameters>.*)\s+SID History:\s+(?<ChangedAttribs_SID_History>.*)\s+Logon Hours:\s+(?<ChangedAttribs_Logon_Hours>.*)" 
| rex field=Message "Additional Information:\s+Privileges:\s+(?<AddtlInfo_Privileges>.*)"
| table _time host sourcetype EventCode summary Subject_Security_ID Subject_Account_Name Subject_Account_Domain Subject_Logon_ID Target_Account_Security_ID Target_Account_Account_Name Target_Account_Account_Domain ChangedAttribs_SAM_Account_Name ChangedAttribs_Display_Name ChangedAttribs_UPN ChangedAttribs_Home_Directory ChangedAttribs_Home_Drive ChangedAttribs_Script_Path ChangedAttribs_Profile_Path ChangedAttribs_User_Workstations ChangedAttribs_Password_Last_Set ChangedAttribs_Account_Expires ChangedAttribs_Primary_Group_ID ChangedAttribs_AllowedDelegateTo ChangedAttribs_Old_UAC_Value ChangedAttribs_New_UAC_Value ChangedAttribs_UserAcctControl ChangedAttribs_User_Parameters ChangedAttribs_SID_History ChangedAttribs_Logon_Hours AddtlInfo_Privileges

# Verified
[An attempt was made to query the existence of a blank password for an account.]
search = sourcetype=WinEventLog:Security EventCode=4797 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Additional Information:\s+Caller Workstation:\s+(?<AddtlInfo_Caller_Wks>.*)\s+Target Account Name:\s+(?<AddtlInfo_Target_Acct_Name>.*)\s+Target Account Domain:\s+(?<AddtlInfo_Target_Acct_Domain>.*)"
| table _time host sourcetype EventCode summary Subject_Security_ID Subject_Account_Name Subject_Account_Domain Subject_Logon_ID AddtlInfo_Caller_Wks AddtlInfo_Target_Acct_Name AddtlInfo_Target_Acct_Domain

# Verified
[A user's local group membership was enumerated.]
sourcetype=WinEventLog:Security EventCode=4798 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "User:\s+Security ID:\s+(?<User_Security_ID>.*)\s+Account Name:\s+(?<User_Account_Name>.*)\s+Account Domain:\s+(?<User_Account_Domain>.*)"
| rex field=Message "Process Information:\s+Process ID:\s+(?<ProcessInfo_Process_ID>.*)\s+Process Name:\s+(?<ProcessInfo_Process_Name>.*)"
| table _time host sourcetype EventCode summary Subject_Security_ID Subject_Account_Name Subject_Account_Domain Subject_Logon_ID User_Security_ID User_Account_Name User_Account_Domain ProcessInfo_Process_ID ProcessInfo_Process_Name

[A security-enabled local group membership was enumerated.]
search = sourcetype=WinEventLog:Security EventCode=4799 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Group:\s+Security ID:\s+(?<Group_Security_ID>.*)\s+Group Name:\s+(?<Group_Group_Name>.*)\s+Group Domain:\s+(?<Group_Group_Domain>.*)"
| rex field=Message "Process ID:\s+(?<ProcessInfo_Process_ID>.*)" 
| rex field=Message "Process Name:\s+(?<ProcessInfo_Process_Name>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, Group_Security_ID, Group_Group_Name, Group_Group_Domain, ProcessInfo_Process_ID, ProcessInfo_Process_Name

[Boot Configuration Data loaded.]
search = sourcetype=WinEventLog:Security EventCode=4826 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Load Options:\s+(?<GeneralSettings_Load_Options>.*)" 
| rex field=Message "Advanced Options:\s+(?<GeneralSettings_Advanced_Options>.*)" 
| rex field=Message "Configuration Access Policy:\s+(?<GeneralSettings_ConfigAccessPol>.*)" 
| rex field=Message "System Event Logging:\s+(?<GeneralSettings_SysEvtLogging>.*)" 
| rex field=Message "Kernel Debugging:\s+(?<GeneralSettings_Kernel_Debugging>.*)" 
| rex field=Message "VSM Launch Type:\s+(?<GeneralSettings_VSM_Launch_Type>.*)" 
| rex field=Message "Test Signing:\s+(?<SigSettings_Test_Signing>.*)" 
| rex field=Message "Flight Signing:\s+(?<SigSettings_Flight_Signing>.*)" 
| rex field=Message "Disable Integrity Checks:\s+(?<SigSettings_DisableIntegChecks>.*)" 
| rex field=Message "HyperVisor Load Options:\s+(?<HyperVisorSettings_LoadOptions>.*)" 
| rex field=Message "HyperVisor Launch Type:\s+(?<HyperVisorSettings_LaunchType>.*)" 
| rex field=Message "HyperVisor Debugging:\s+(?<HyperVisorSettings_Debugging>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, GeneralSettings_Load_Options, GeneralSettings_Advanced_Options, GeneralSettings_ConfigAccessPol, GeneralSettings_SysEvtLogging, GeneralSettings_Kernel_Debugging, GeneralSettings_VSM_Launch_Type, SigSettings_Test_Signing, SigSettings_Flight_Signing, SigSettings_DisableIntegChecks, HyperVisorSettings_LoadOptions, HyperVisorSettings_LaunchType, HyperVisorSettings_Debugging

[The Per-user audit policy table was created.]
search = sourcetype=WinEventLog:Security EventCode=4902
| rex field=Message "(?<summary>.*)"
| rex field=Message "Number of Elements:\s+(?<Number_Of_Elements>.*)"
| rex field=Message "Policy ID:\s+(?<Policy_ID>.*)"
| table _time host sourcetype EventCode summary Number_Of_Elements Policy_ID

[An attempt was made to register a security event source.]
search = sourcetype=WinEventLog:Security EventCode=4904 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject :\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Process ID:\s+(?<Process_Process_ID>.*)" 
| rex field=Message "Process Name:\s+(?<Process_Process_Name>.*)" 
| rex field=Message "Source Name:\s+(?<Event_Source_Source_Name>.*)" 
| rex field=Message "Event Source ID:\s+(?<Event_Source_Event_Source_ID>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, Process_Process_ID, Process_Process_Name, Event_Source_Source_Name, Event_Source_Event_Source_ID

[An attempt was made to unregister a security event source.]
search = sourcetype=WinEventLog:Security EventCode=4905 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Process ID:\s+(?<Process_Process_ID>.*)" 
| rex field=Message "Process Name:\s+(?<Process_Process_Name>.*)" 
| rex field=Message "Source Name:\s+(?<Event_Source_Source_Name>.*)" 
| rex field=Message "Event Source ID:\s+(?<Event_Source_Event_Source_ID>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, Process_Process_ID, Process_Process_Name, Event_Source_Source_Name, Event_Source_Event_Source_ID

[The state of a transaction has changed.]
search = sourcetype=WinEventLog:Security EventCode=4985 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "RM Transaction ID:\s+(?<TransactionInfo_RM_TransID>.*)" 
| rex field=Message "New State:\s+(?<TransactionInfo_New_State>.*)" 
| rex field=Message "Resource Manager:\s+(?<TransactionInfo_Resource_Manager>.*)" 
| rex field=Message "Process ID:\s+(?<ProcessInfo_Process_ID>.*)" 
| rex field=Message "Process Name:\s+(?<ProcessInfo_Process_Name>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, TransactionInfo_RM_TransID, TransactionInfo_New_State, TransactionInfo_Resource_Manager, ProcessInfo_Process_ID, ProcessInfo_Process_Name

[The Windows Firewall service started successfully.]
search = sourcetype=WinEventLog:Security EventCode=5024 
| rex field=Message "(?<summary>.*)"
| table _time host sourcetype EventCode summary

[The Windows Firewall Driver started successfully.]
search = sourcetype=WinEventLog:Security EventCode=5033 
| rex field=Message "(?<summary>.*)"
| table _time host sourcetype EventCode summary

[Key file operation.]
search = sourcetype=WinEventLog:Security EventCode=5058 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Provider Name:\s+(?<CryptoParams_Provider_Name>.*)" 
| rex field=Message "Algorithm Name:\s+(?<CryptoParams_Algorithm_Name>.*)" 
| rex field=Message "Key Name:\s+(?<CryptoParams_Key_Name>.*)" 
| rex field=Message "Key Type:\s+(?<CryptoParams_Key_Type>.*)" 
| rex field=Message "File Path:\s+(?<KeyFileOpInfo_File_Path>.*)" 
| rex field=Message "Operation:\s+(?<KeyFileOpInfo_Operation>.*)" 
| rex field=Message "Return Code:\s+(?<KeyFileOpInfo_Return_Code>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, CryptoParams_Provider_Name, CryptoParams_Algorithm_Name, CryptoParams_Key_Name, CryptoParams_Key_Type, KeyFileOpInfo_File_Path, KeyFileOpInfo_Operation, KeyFileOpInfo_Return_Code

[Key migration operation.]
search = sourcetype=WinEventLog:Security EventCode=5059 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Provider Name:\s+(?<CryptoParams_Provider_Name>.*)" 
| rex field=Message "Algorithm Name:\s+(?<CryptoParams_Algorithm_Name>.*)" 
| rex field=Message "Key Name:\s+(?<CryptoParams_Key_Name>.*)" 
| rex field=Message "Key Type:\s+(?<CryptoParams_Key_Type>.*)" 
| rex field=Message "Operation:\s+(?<AddtlInfo_Operation>.*)" 
| rex field=Message "Return Code:\s+(?<AddtlInfo_Return_Code>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, CryptoParams_Provider_Name, CryptoParams_Algorithm_Name, CryptoParams_Key_Name, CryptoParams_Key_Type, AddtlInfo_Operation, AddtlInfo_Return_Code

[Cryptographic operation.]
search = sourcetype=WinEventLog:Security EventCode=5061 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Provider Name:\s+(?<CryptoParams_Provider_Name>.*)" 
| rex field=Message "Algorithm Name:\s+(?<CryptoParams_Algorithm_Name>.*)" 
| rex field=Message "Key Name:\s+(?<CryptoParams_Key_Name>.*)" 
| rex field=Message "Key Type:\s+(?<CryptoParams_Key_Type>.*)" 
| rex field=Message "Operation:\s+(?<CryptoOp_Operation>.*)" 
| rex field=Message "Return Code:\s+(?<CryptoOp_Return_Code>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, CryptoParams_Provider_Name, CryptoParams_Algorithm_Name, CryptoParams_Key_Name, CryptoParams_Key_Type, CryptoOp_Operation, CryptoOp_Return_Code

[An active directory service object was modified]
search = sourcetype=WinEventLog:Security EventCode=5136 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)" 
| rex field=Message "Directory Service:\s+Name:\s+(?<DS_Name>.*)\s+Type:\s+(?<DS_Type>.*)" 
| rex field=Message "Object:\s+DN:\s+(?<Obj_DN>.*)\s+GUID:\s+(?<Obj_GUID>.*)\s+Class:\s+(?<Obj_Class>.*)" 
| rex field=Message "Attribute:\s+LDAP Display Name:\s+(?<Attr_LDAP_Display_Name>.*)\s+Syntax \(OID\):\s+(?<Attr_OID>.*)\s+Value:\s+(?<Attr_Value>.*)" 
| rex field=Message "Operation:\s+Type:\s+(?<Op_Type>.*)\s+Correlation ID:\s+(?<Op_Corr_ID>.*)\s+Application Correlation ID:\s+(?<Op_App_Corr_ID>.*)" 
| table _time host sourcetype EventCode summary Subject_Security_ID Subject_Account_Name Subject_Account_Domain Subject_Logon_ID DS_Name DS_Type Obj_DN Obj_GUID Obj_Class Attr_LDAP_Display_Name Attr_OID Attr_Value Op_Type Op_Corr_ID Op_App_Corr_ID

[A network share object was accessed.]
search = sourcetype=WinEventLog:Security EventCode=5140 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Object Type:\s+(?<NetInfo_Object_Type>.*)" 
| rex field=Message "Source Address:\s+(?<NetInfo_Source_Address>.*)" 
| rex field=Message "Source Port:\s+(?<NetInfo_Source_Port>.*)" 
| rex field=Message "Share Name:\s+(?<Share_Information_Share_Name>.*)" 
| rex field=Message "Share Path:\s+(?<Share_Information_Share_Path>.*)" 
| rex field=Message "Access Mask:\s+(?<AccessReqInfo_Access_Mask>.*)" 
| rex field=Message "Accesses:\s+(?<AccessReqInfo_Accesses>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, NetInfo_Object_Type, NetInfo_Source_Address, NetInfo_Source_Port, Share_Information_Share_Name, Share_Information_Share_Path, AccessReqInfo_Access_Mask, AccessReqInfo_Accesses

[A network share object was added.]
search = sourcetype=WinEventLog:Security EventCode=5142 
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Share Name:\s+(?<Share_Information_Share_Name>.*)" 
| rex field=Message "Share Path:\s+(?<Share_Information_Share_Path>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, Share_Information_Share_Name, Share_Information_Share_Path



[Account Logon:Credential Validation:4774 - An account was mapped for logon.]
search = sourcetype="WinEventLog:Security" EventCode="4774"
| TODO

[Account Logon:Credential Validation:4775 - An account could not be mapped for logon.]
search = sourcetype="WinEventLog:Security" EventCode="4775"
| TODO

[Account Logon:Credential Validation:4776 - The domain controller attempted to validate the credentials for an account.]
search = sourcetype="WinEventLog:Security" EventCode="4776"
| TODO

[Account Logon:Credential Validation:4777 - The domain controller failed to validate the credentials for an account.]
search = sourcetype="WinEventLog:Security" EventCode="4777"
| TODO

[Account Logon:Kerberos Authentication Service:4768 - A Kerberos authentication ticket (TGT) was requested.]
search = sourcetype="WinEventLog:Security" EventCode="4768"
| TODO

[Account Logon:Kerberos Authentication Service:4771 - Kerberos pre-authentication failed.]
search = sourcetype="WinEventLog:Security" EventCode="4771"
| TODO

[Account Logon:Kerberos Authentication Service:4772 - A Kerberos authentication ticket request failed.]
search = sourcetype="WinEventLog:Security" EventCode="4772"
| TODO

[Account Logon:Kerberos Service Ticket Operations:4769 - A Kerberos service ticket was requested.]
search = sourcetype="WinEventLog:Security" EventCode="4769"
| TODO

[Account Logon:Kerberos Service Ticket Operations:4770 - A Kerberos service ticket was renewed.]
search = sourcetype="WinEventLog:Security" EventCode="4770"
| TODO

[Account Management:Application Group Management:4783 - A basic application group was created.]
search = sourcetype="WinEventLog:Security" EventCode="4783"
| TODO

[Account Management:Application Group Management:4784 - A basic application group was changed.]
search = sourcetype="WinEventLog:Security" EventCode="4784"
| TODO

[Account Management:Application Group Management:4785 - A member was added to a basic application group.]
search = sourcetype="WinEventLog:Security" EventCode="4785"
| TODO

[Account Management:Application Group Management:4786 - A member was removed from a basic application group.]
search = sourcetype="WinEventLog:Security" EventCode="4786"
| TODO

[Account Management:Application Group Management:4787 - A non-member was added to a basic application group.]
search = sourcetype="WinEventLog:Security" EventCode="4787"
| TODO

[Account Management:Application Group Management:4788 - A non-member was removed from a basic application group.]
search = sourcetype="WinEventLog:Security" EventCode="4788"
| TODO

[Account Management:Application Group Management:4789 - A basic application group was deleted.]
search = sourcetype="WinEventLog:Security" EventCode="4789"
| TODO

[Account Management:Application Group Management:4790 - An LDAP query group was created.]
search = sourcetype="WinEventLog:Security" EventCode="4790"
| TODO

[Account Management:Computer Account Management:4742 - A computer account was changed.]
search = sourcetype="WinEventLog:Security" EventCode="4742"
| TODO

[Account Management:Computer Account Management:4743 - A computer account was deleted.]
search = sourcetype="WinEventLog:Security" EventCode="4743"
| TODO

[Account Management:Distribution Group Management:4744 - A security-disabled local group was created.]
search = sourcetype="WinEventLog:Security" EventCode="4744"
| TODO

[Account Management:Distribution Group Management:4745 - A security-disabled local group was changed.]
search = sourcetype="WinEventLog:Security" EventCode="4745"
| TODO

[Account Management:Distribution Group Management:4746 - A member was added to a security-disabled local group.]
search = sourcetype="WinEventLog:Security" EventCode="4746"
| TODO

[Account Management:Distribution Group Management:4747 - A member was removed from a security-disabled local group.]
search = sourcetype="WinEventLog:Security" EventCode="4747"
| TODO

[Account Management:Distribution Group Management:4748 - A security-disabled local group was deleted.]
search = sourcetype="WinEventLog:Security" EventCode="4748"
| TODO

[Account Management:Distribution Group Management:4749 - A security-disabled global group was created.]
search = sourcetype="WinEventLog:Security" EventCode="4749"
| TODO

[Account Management:Distribution Group Management:4750 - A security-disabled global group was changed.]
search = sourcetype="WinEventLog:Security" EventCode="4750"
| TODO

[Account Management:Distribution Group Management:4751 - A member was added to a security-disabled global group.]
search = sourcetype="WinEventLog:Security" EventCode="4751"
| TODO

[Account Management:Distribution Group Management:4752 - A member was removed from a security-disabled global group.]
search = sourcetype="WinEventLog:Security" EventCode="4752"
| TODO

[Account Management:Distribution Group Management:4753 - A security-disabled global group was deleted.]
search = sourcetype="WinEventLog:Security" EventCode="4753"
| TODO

[Account Management:Distribution Group Management:4759 - A security-disabled universal group was created.]
search = sourcetype="WinEventLog:Security" EventCode="4759"
| TODO

[Account Management:Distribution Group Management:4760 - A security-disabled universal group was changed.]
search = sourcetype="WinEventLog:Security" EventCode="4760"
| TODO

[Account Management:Distribution Group Management:4761 - A member was added to a security-disabled universal group.]
search = sourcetype="WinEventLog:Security" EventCode="4761"
| TODO

[Account Management:Distribution Group Management:4762 - A member was removed from a security-disabled universal group.]
search = sourcetype="WinEventLog:Security" EventCode="4762"
| TODO

[Account Management:Other Account Management Events:4782 - The password hash an account was accessed.]
search = sourcetype="WinEventLog:Security" EventCode="4782"
| TODO

[Account Management:Other Account Management Events:4793 - The Password Policy Checking API was called.]
search = sourcetype="WinEventLog:Security" EventCode="4793"
| TODO

[Account Management:Security Group Management:4727 - A security-enabled global group was created.]
search = sourcetype="WinEventLog:Security" EventCode="4727"
| TODO

[Account Management:Security Group Management:4728 - A member was added to a security-enabled global group.]
search = sourcetype="WinEventLog:Security" EventCode="4728"
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Member:\s+Security ID:\s+(?<Member_Security_ID>.*)\s+Account Name:\s+(?<Member_Account_Account_Name>.*)"
| rex field=Message "Group:\s+Security ID:\s+(?<Group_Security_ID>.*)\s+Group Name:\s+(?<Group_Group_Name>.*)\s+Group Domain:\s+(?<Group_Group_Domain>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, Member_Security_ID Member_Account_Account_Name Group_Security_ID Group_Group_Name Group_Group_Domain

[Account Management:Security Group Management:4729 - A member was removed from a security-enabled global group.]
search = sourcetype="WinEventLog:Security" EventCode="4729"
| TODO

[Account Management:Security Group Management:4730 - A security-enabled global group was deleted.]
search = sourcetype="WinEventLog:Security" EventCode="4730"
| TODO

[Account Management:Security Group Management:4731 - A security-enabled local group was created.]
search = sourcetype="WinEventLog:Security" EventCode="4731"
| TODO

[Account Management:Security Group Management:4732 - A member was added to a security-enabled local group.]
search = sourcetype="WinEventLog:Security" EventCode="4732"
| TODO

[Account Management:Security Group Management:4733 - A member was removed from a security-enabled local group.]
search = sourcetype="WinEventLog:Security" EventCode="4733"
| TODO

[Account Management:Security Group Management:4734 - A security-enabled local group was deleted.]
search = sourcetype="WinEventLog:Security" EventCode="4734"
| TODO

[Account Management:Security Group Management:4735 - A security-enabled local group was changed.]
search = sourcetype="WinEventLog:Security" EventCode="4735"
| TODO

[Account Management:Security Group Management:4737 - A security-enabled global group was changed.]
search = sourcetype="WinEventLog:Security" EventCode="4737"
| TODO

[Account Management:Security Group Management:4754 - A security-enabled universal group was created.]
search = sourcetype="WinEventLog:Security" EventCode="4754"
| TODO

[Account Management:Security Group Management:4755 - A security-enabled universal group was changed.]
search = sourcetype="WinEventLog:Security" EventCode="4755"
| TODO

[Account Management:Security Group Management:4756 - A member was added to a security-enabled universal group.]
search = sourcetype="WinEventLog:Security" EventCode="4756"
| TODO

[Account Management:Security Group Management:4757 - A member was removed from a security-enabled universal group.]
search = sourcetype="WinEventLog:Security" EventCode="4757"
| TODO

[Account Management:Security Group Management:4758 - A security-enabled universal group was deleted.]
search = sourcetype="WinEventLog:Security" EventCode="4758"
| TODO

[Account Management:Security Group Management:4764 - A group?s type was changed.]
search = sourcetype="WinEventLog:Security" EventCode="4764"
| TODO

[Account Management:User Account Management:4720 - A user account was created.]
search = sourcetype="WinEventLog:Security" EventCode="4720"
| TODO

[Account Management:User Account Management:4722 - A user account was enabled.]
search = sourcetype="WinEventLog:Security" EventCode="4722"
| TODO

[Account Management:User Account Management:4723 - An attempt was made to change an account's password.]
search = sourcetype="WinEventLog:Security" EventCode="4723"
| TODO

[Account Management:User Account Management:4724 - An attempt was made to reset an account's password.]
search = sourcetype="WinEventLog:Security" EventCode="4724"
| TODO

[Account Management:User Account Management:4725 - A user account was disabled.]
search = sourcetype="WinEventLog:Security" EventCode="4725"
| TODO

[Account Management:User Account Management:4726 - A user account was deleted.]
search = sourcetype="WinEventLog:Security" EventCode="4726"
| TODO

[Account Management:User Account Management:4738 - A user account was changed.]
search = sourcetype="WinEventLog:Security" EventCode="4738"
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Target Account:\s+Security ID:\s+(?<Target_Account_Security_ID>.*)\s+Account Name:\s+(?<Target_Account_Account_Name>.*)\s+Account Domain:\s+(?<Target_Account_Account_Domain>.*)" 
| rex field=Message "SAM Account Name:\s+(?<ChangedAttribs_SAM_Account_Name>.*)" 
| rex field=Message "Display Name:\s+(?<ChangedAttribs_Display_Name>.*)" 
| rex field=Message "User Principal Name:\s+(?<ChangedAttribs_UPN>.*)" 
| rex field=Message "Home Directory:\s+(?<ChangedAttribs_Home_Directory>.*)" 
| rex field=Message "Home Drive:\s+(?<ChangedAttribs_Home_Drive>.*)" 
| rex field=Message "Script Path:\s+(?<ChangedAttribs_Script_Path>.*)" 
| rex field=Message "Profile Path:\s+(?<ChangedAttribs_Profile_Path>.*)" 
| rex field=Message "User Workstations:\s+(?<ChangedAttribs_User_Workstations>.*)" 
| rex field=Message "Password Last Set:\s+(?<ChangedAttribs_Password_Last_Set>.*)" 
| rex field=Message "Account Expires:\s+(?<ChangedAttribs_Account_Expires>.*)" 
| rex field=Message "Primary Group ID:\s+(?<ChangedAttribs_Primary_Group_ID>.*)" 
| rex field=Message "AllowedToDelegateTo:\s+(?<ChangedAttribs_AllowedDelegateTo>.*)" 
| rex field=Message "Old UAC Value:\s+(?<ChangedAttribs_Old_UAC_Value>.*)" 
| rex field=Message "New UAC Value:\s+(?<ChangedAttribs_New_UAC_Value>.*)" 
| rex field=Message "User Account Control:\s+(?<ChangedAttribs_UserAcctControl>.*)" 
| rex field=Message "User Parameters:\s+(?<ChangedAttribs_User_Parameters>.*)" 
| rex field=Message "SID History:\s+(?<ChangedAttribs_SID_History>.*)" 
| rex field=Message "Logon Hours:\s+(?<ChangedAttribs_Logon_Hours>.*)" 
| rex field=Message "Privileges:\s+(?<AddtlInfo_Privileges>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, Target_Account_Security_ID, Target_Account_Account_Name, Target_Account_Account_Domain, ChangedAttribs_SAM_Account_Name, ChangedAttribs_Display_Name, ChangedAttribs_UPN, ChangedAttribs_Home_Directory, ChangedAttribs_Home_Drive, ChangedAttribs_Script_Path, ChangedAttribs_Profile_Path, ChangedAttribs_User_Workstations, ChangedAttribs_Password_Last_Set, ChangedAttribs_Account_Expires, ChangedAttribs_Primary_Group_ID, ChangedAttribs_AllowedDelegateTo, ChangedAttribs_Old_UAC_Value, ChangedAttribs_New_UAC_Value, ChangedAttribs_UserAcctControl, ChangedAttribs_User_Parameters, ChangedAttribs_SID_History, ChangedAttribs_Logon_Hours, AddtlInfo_Privileges

[Account Management:User Account Management:4740 - A user account was locked out.]
search = sourcetype="WinEventLog:Security" EventCode="4740"
| TODO

[Account Management:User Account Management:4765 - SID History was added to an account.]
search = sourcetype="WinEventLog:Security" EventCode="4765"
| TODO

[Account Management:User Account Management:4766 - An attempt to add SID History to an account failed.]
search = sourcetype="WinEventLog:Security" EventCode="4766"
| TODO

[Account Management:User Account Management:4767 - A user account was unlocked.]
search = sourcetype="WinEventLog:Security" EventCode="4767"
| TODO

[Account Management:User Account Management:4780 - The ACL was set on accounts which are members of administrators groups.]
search = sourcetype="WinEventLog:Security" EventCode="4780"
| TODO

[Account Management:User Account Management:4781 - The name of an account was changed:]
search = sourcetype="WinEventLog:Security" EventCode="4781"
| TODO

[Account Management:User Account Management:4794 - An attempt was made to set the Directory Services Restore Mode.]
search = sourcetype="WinEventLog:Security" EventCode="4794"
| TODO

[Account Management:User Account Management:5376 - Credential Manager credentials were backed up.]
search = sourcetype="WinEventLog:Security" EventCode="5376"
| TODO

[Account Management:User Account Management:5377 - Credential Manager credentials were restored from a backup.]
search = sourcetype="WinEventLog:Security" EventCode="5377"
| TODO

[Detailed Tracking:DPAPI Activity:4692 - Backup of data protection master key was attempted.]
search = sourcetype="WinEventLog:Security" EventCode="4692"
| TODO

[Detailed Tracking:DPAPI Activity:4693 - Recovery of data protection master key was attempted.]
search = sourcetype="WinEventLog:Security" EventCode="4693"
| TODO

[Detailed Tracking:DPAPI Activity:4694 - Protection of auditable protected data was attempted.]
search = sourcetype="WinEventLog:Security" EventCode="4694"
| TODO

[Detailed Tracking:DPAPI Activity:4695 - Unprotection of auditable protected data was attempted.]
search = sourcetype="WinEventLog:Security" EventCode="4695"
| TODO

[Detailed Tracking:Process Creation:4688 - A new process has been created.]
search = sourcetype="WinEventLog:Security" EventCode="4688"
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Creator Subject:\s+Security ID:\s+(?<Creator_Subject_Security_ID>.*)\s+Account Name:\s+(?<Creator_Subject_Account_Name>.*)\s+Account Domain:\s+(?<Creator_Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Creator_Subject_Logon_ID>.*)"
| rex field=Message "Target Subject:\s+Security ID:\s+(?<Target_Subject_Security_ID>.*)\s+Account Name:\s+(?<Target_Subject_Account_Name>.*)\s+Account Domain:\s+(?<Target_Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Target_Subject_Logon_ID>.*)"
| rex field=Message "New Process ID:\s+(?<ProcessInfo_New_Process_ID>.*)" 
| rex field=Message "New Process Name:\s+(?<ProcessInfo_New_Process_Name>.*)" 
| rex field=Message "Token Elevation Type:\s+(?<ProcessInfo_Token_Elevation_Type>.*)" 
| rex field=Message "Mandatory Label:\s+(?<ProcessInfo_Mandatory_Label>.*)" 
| rex field=Message "Creator Process ID:\s+(?<ProcessInfo_Creator_Process_ID>.*)" 
| rex field=Message "Creator Process Name:\s+(?<ProcessInfo_Creator_Process_Name>.*)" 
| rex field=Message "Process Command Line:\s+(?<ProcessInfo_Process_Command_Line>.*)"
| eval ProcessInfo_Process_Command_Line = if(ProcessInfo_Process_Command_Line LIKE "Token Elevation Type%","",ProcessInfo_Process_Command_Line)
| table _time host sourcetype EventCode summary, Creator_Subject_Security_ID, Creator_Subject_Account_Name, Creator_Subject_Account_Domain, Creator_Subject_Logon_ID, Target_Subject_Security_ID, Target_Subject_Account_Name, Target_Subject_Account_Domain, Target_Subject_Logon_ID, ProcessInfo_New_Process_ID, ProcessInfo_New_Process_Name, ProcessInfo_Token_Elevation_Type, ProcessInfo_Mandatory_Label, ProcessInfo_Creator_Process_ID, ProcessInfo_Creator_Process_Name, ProcessInfo_Process_Command_Line

[Detailed Tracking:Process Creation:4696 - A primary token was assigned to process.]
search = sourcetype="WinEventLog:Security" EventCode="4696"
| TODO

[Detailed Tracking:Process Termination:4689 - A process has exited.]
search = sourcetype="WinEventLog:Security" EventCode="4689"
| TODO

[Detailed Tracking:RPC Events:5712 - A Remote Procedure Call (RPC) was attempted.]
search = sourcetype="WinEventLog:Security" EventCode="5712"
| TODO

[DS Access:Detailed Directory Service Replication:4928 - An Active Directory replica source naming context was established.]
search = sourcetype="WinEventLog:Security" EventCode="4928"
| TODO

[DS Access:Detailed Directory Service Replication:4929 - An Active Directory replica source naming context was removed.]
search = sourcetype="WinEventLog:Security" EventCode="4929"
| TODO

[DS Access:Detailed Directory Service Replication:4930 - An Active Directory replica source naming context was modified.]
search = sourcetype="WinEventLog:Security" EventCode="4930"
| TODO

[DS Access:Detailed Directory Service Replication:4931 - An Active Directory replica destination naming context was modified.]
search = sourcetype="WinEventLog:Security" EventCode="4931"
| TODO

[DS Access:Detailed Directory Service Replication:4934 - Attributes of an Active Directory object were replicated.]
search = sourcetype="WinEventLog:Security" EventCode="4934"
| TODO

[DS Access:Detailed Directory Service Replication:4935 - Replication failure begins.]
search = sourcetype="WinEventLog:Security" EventCode="4935"
| TODO

[DS Access:Detailed Directory Service Replication:4936 - Replication failure ends.]
search = sourcetype="WinEventLog:Security" EventCode="4936"
| TODO

[DS Access:Detailed Directory Service Replication:4937 - A lingering object was removed from a replica.]
search = sourcetype="WinEventLog:Security" EventCode="4937"
| TODO

[DS Access:Directory Service Access:4662 - An operation was performed on an object.]
search = sourcetype="WinEventLog:Security" EventCode="4662"
| TODO

[DS Access:Directory Service Changes:5136 - A directory service object was modified.]
search = sourcetype="WinEventLog:Security" EventCode="5136"
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)" 
| rex field=Message "Directory Service:\s+Name:\s+(?<DS_Name>.*)\s+Type:\s+(?<DS_Type>.*)" 
| rex field=Message "Object:\s+DN:\s+(?<Obj_DN>.*)\s+GUID:\s+(?<Obj_GUID>.*)\s+Class:\s+(?<Obj_Class>.*)" 
| rex field=Message "Attribute:\s+LDAP Display Name:\s+(?<Attr_LDAP_Display_Name>.*)\s+Syntax \(OID\):\s+(?<Attr_OID>.*)\s+Value:\s+(?<Attr_Value>.*)" 
| rex field=Message "Operation:\s+Type:\s+(?<Op_Type>.*)\s+Correlation ID:\s+(?<Op_Corr_ID>.*)\s+Application Correlation ID:\s+(?<Op_App_Corr_ID>.*)" 
| table _time host sourcetype EventCode summary Subject_Security_ID Subject_Account_Name Subject_Account_Domain Subject_Logon_ID DS_Name DS_Type Obj_DN Obj_GUID Obj_Class Attr_LDAP_Display_Name Attr_OID Attr_Value Op_Type Op_Corr_ID Op_App_Corr_ID

[DS Access:Directory Service Changes:5137 - A directory service object was created.]
search = sourcetype="WinEventLog:Security" EventCode="5137"
| TODO

[DS Access:Directory Service Changes:5138 - A directory service object was undeleted.]
search = sourcetype="WinEventLog:Security" EventCode="5138"
| TODO

[DS Access:Directory Service Changes:5139 - A directory service object was moved.]
search = sourcetype="WinEventLog:Security" EventCode="5139"
| TODO

[DS Access:Directory Service Changes:5141 - A directory service object was deleted.]
search = sourcetype="WinEventLog:Security" EventCode="5141"
| TODO

[DS Access:Directory Service Replication:4932 - Synchronization of a replica of an Active Directory naming context has begun.]
search = sourcetype="WinEventLog:Security" EventCode="4932"
| TODO

[DS Access:Directory Service Replication:4933 - Synchronization of a replica of an Active Directory naming context has ended.]
search = sourcetype="WinEventLog:Security" EventCode="4933"
| TODO

[Logon/Logoff:Account Lockout:4625 - An account failed to logon]
search = sourcetype="WinEventLog:Security" EventCode="4625"
(Sub_Status="0xc0000072" OR Sub_Status="0xC0000072") Security_ID!="NULL SID" Account_Name!="*$" 
 | eval Date=strftime(_time, "%Y/%m/%d")
 | rex "Which\sLogon\sFailed:\s+\S+\s\S+\s+\S+\s+Account\sName:\s+(?<facct>\S+)" 
 | eval Date=strftime(_time, "%Y/%m/%d") 
 | stats count by Date, facct, host, Keywords 
 | rename facct as "Target Account" host as Host Keywords as Status count as Count

[Logon/Logoff:IPsec Extended Mode:4978 - During Extended Mode negotiation, IPsec received an invalid negotiation packet. If this problem persists, it could indicate a network issue or an attempt to modify or replay this negotiation.]
search = sourcetype="WinEventLog:Security" EventCode="4978"
| TODO

[Logon/Logoff:IPsec Extended Mode:4979 - IPsec Main Mode and Extended Mode security associations were established.]
search = sourcetype="WinEventLog:Security" EventCode="4979"
| TODO

[Logon/Logoff:IPsec Extended Mode:4980 - IPsec Main Mode and Extended Mode security associations were established.]
search = sourcetype="WinEventLog:Security" EventCode="4980"
| TODO

[Logon/Logoff:IPsec Extended Mode:4981 - IPsec Main Mode and Extended Mode security associations were established.]
search = sourcetype="WinEventLog:Security" EventCode="4981"
| TODO

[Logon/Logoff:IPsec Extended Mode:4982 - IPsec Main Mode and Extended Mode security associations were established.]
search = sourcetype="WinEventLog:Security" EventCode="4982"
| TODO

[Logon/Logoff:IPsec Extended Mode:4983 - An IPsec Extended Mode negotiation failed. The corresponding Main Mode security association has been deleted.]
search = sourcetype="WinEventLog:Security" EventCode="4983"
| TODO

[Logon/Logoff:IPsec Extended Mode:4984 - An IPsec Extended Mode negotiation failed. The corresponding Main Mode security association has been deleted.]
search = sourcetype="WinEventLog:Security" EventCode="4984"
| TODO

[Logon/Logoff:IPsec Main Mode:4646 - IKE DoS-prevention mode started.]
search = sourcetype="WinEventLog:Security" EventCode="4646"
| TODO

[Logon/Logoff:IPsec Main Mode:4650 - An IPsec Main Mode security association was established. Extended Mode was not enabled. Certificate authentication was not used.]
search = sourcetype="WinEventLog:Security" EventCode="4650"
| TODO

[Logon/Logoff:IPsec Main Mode:4651 - An IPsec Main Mode security association was established. Extended Mode was not enabled. A certificate was used for authentication.]
search = sourcetype="WinEventLog:Security" EventCode="4651"
| TODO

[Logon/Logoff:IPsec Main Mode:4652 - An IPsec Main Mode negotiation failed.]
search = sourcetype="WinEventLog:Security" EventCode="4652"
| TODO

[Logon/Logoff:IPsec Main Mode:4653 - An IPsec Main Mode negotiation failed.]
search = sourcetype="WinEventLog:Security" EventCode="4653"
| TODO

[Logon/Logoff:IPsec Main Mode:4655 - An IPsec Main Mode security association ended.]
search = sourcetype="WinEventLog:Security" EventCode="4655"
| TODO

[Logon/Logoff:IPsec Main Mode:4976 - During Main Mode negotiation, IPsec received an invalid negotiation packet. If this problem persists, it could indicate a network issue or an attempt to modify or replay this negotiation.]
search = sourcetype="WinEventLog:Security" EventCode="4976"
| TODO

[Logon/Logoff:IPsec Main Mode:5049 - An IPsec Security Association was deleted.]
search = sourcetype="WinEventLog:Security" EventCode="5049"
| TODO

[Logon/Logoff:IPsec Main Mode:5453 - An IPsec negotiation with a remote computer failed because the IKE and AuthIP IPsec Keying Modules (IKEEXT) service is not started.]
search = sourcetype="WinEventLog:Security" EventCode="5453"
| TODO

[Logon/Logoff:IPsec Quick Mode:4654 - An IPsec Quick Mode negotiation failed.]
search = sourcetype="WinEventLog:Security" EventCode="4654"
| TODO

[Logon/Logoff:IPsec Quick Mode:4977 - During Quick Mode negotiation, IPsec received an invalid negotiation packet. If this problem persists, it could indicate a network issue or an attempt to modify or replay this negotiation.]
search = sourcetype="WinEventLog:Security" EventCode="4977"
| TODO

[Logon/Logoff:IPsec Quick Mode:5451 - An IPsec Quick Mode security association was established.]
search = sourcetype="WinEventLog:Security" EventCode="5451"
| TODO

[Logon/Logoff:IPsec Quick Mode:5452 - An IPsec Quick Mode security association ended.]
search = sourcetype="WinEventLog:Security" EventCode="5452"
| TODO

[Logon/Logoff:Logoff:4634 - An account was logged off.]
search = sourcetype="WinEventLog:Security" EventCode="4634"
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Logon Type:\s+(?<Logon_Type>\d+)"
| eval Logon_Type_Desc = case(Logon_Type==2,"Interactive",Logon_Type==3,"Network",Logon_Type==4,"Batch",Logon_Type==5,"Service",Logon_Type==7,"Unlock",Logon_Type==8,"NetworkCleartext",Logon_Type_Desc==9,"NewCredentials",Logon_Type==10,"RemoteInteractive",Logon_Type==11,"CachedInteractive",1==1,"Unknown")
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, Logon_Type Logon_Type_Desc

[Logon/Logoff:Logoff:4647 - User initiated logoff.]
search = sourcetype="WinEventLog:Security" EventCode="4647"
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID

[Logon/Logoff:Logon:4624 - An account was successfully logged on.]
search = sourcetype="WinEventLog:Security" EventCode="4624"
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Logon Type:\s+(?<Logon_Info_Logon_Type>.*)"
| rex field=Message "Restricted Admin Mode:\s+(?<Logon_Info_Restricted_Admin_Mode>.*)"
| rex field=Message "Virtual Account:\s+(?<Logon_Info_Virtual_Account>.*)"
| rex field=Message "Elevated Token:\s+(?<Logon_Info_Elevated_Token>.*)"
| rex field=Message "Impersonation Level:\s+(?<Impersonation_Level>.*)"
| rex field=Message "New Logon:\s+Security ID:\s+(?<New_Logon_Security_ID>.*)\s+Account Name:\s+(?<New_Logon_Account_Name>.*)\s+Account Domain:\s+(?<New_Logon_Account_Domain>.*)\s+Logon ID:\s+(?<New_Logon_Logon_ID>.*)"
| rex field=Message "Linked Logon ID:\s+(?<New_Logon_Linked_Logon_ID>.*)"
| rex field=Message "Network Account Name:\s+(?<New_Logon_Network_Account_Name>.*)"
| rex field=Message "Network Account Domain:\s+(?<New_Logon_Network_Account_Domain>.*)"
| rex field=Message "Logon GUID:\s+(?<New_Logon_Logon_GUID>.*)"
| rex field=Message "Process ID:\s+(?<ProcessInfo_Process_ID>.*)" 
| rex field=Message "Process Name:\s+(?<ProcessInfo_Process_Name>.*)"
| rex field=Message "Workstation Name:\s+(?<NetInfo_Workstation_Name>.*)" 
| rex field=Message "Source Network Address:\s+(?<NetInfo_Source_Net_Address>.*)" 
| rex field=Message "Source Port:\s+(?<NetInfo_Source_Port>.*)"
| rex field=Message "Logon Process::\s+(?<DetailedAuth_Logon_Process>.*)" 
| rex field=Message "Authentication Package:\s+(?<DetailedAuth_Package>.*)" 
| rex field=Message "Transited Services:\s+(?<DetailedAuth_Transited_Svcs>.*)" 
| rex field=Message "Package Name (NTLM only):\s+(?<DetailedAuth_PkgName>.*)"
| rex field=Message "Key Length:\s+(?<DetailedAuth_KeyLength>.*)" 
| table _time host sourcetype EventCode summary Subject_Security_ID Subject_Account_Name Subject_Account_Domain Subject_Logon_ID Logon_Info_Logon_Type Logon_Info_Restricted_Admin_Mode Logon_Info_Virtual_Account Logon_Info_Elevated_Token Impersonation_Level New_Logon_Security_ID New_Logon_Account_Name New_Logon_Account_Domain New_Logon_Logon_ID New_Logon_Linked_Logon_ID New_Logon_Network_Account_Name New_Logon_Network_Account_Domain New_Logon_Logon_GUID ProcessInfo_Process_ID ProcessInfo_Process_Name NetInfo_Workstation_Name NetInfo_Source_Net_Address NetInfo_Source_Port DetailedAuth_Logon_Process DetailedAuth_Transited_Svcs DetailedAuth_PkgName DetailedAuth_KeyLength

[Logon/Logoff:Logon:4625 - An account failed to log on.]
search = sourcetype="WinEventLog:Security" EventCode="4625"
(Sub_Status="0xc0000072" OR Sub_Status="0xC0000072") Security_ID!="NULL SID" Account_Name!="*$" 
 | eval Date=strftime(_time, "%Y/%m/%d")
 | rex "Which\sLogon\sFailed:\s+\S+\s\S+\s+\S+\s+Account\sName:\s+(?<facct>\S+)" 
 | eval Date=strftime(_time, "%Y/%m/%d") 
 | stats count by Date, facct, host, Keywords 
 | rename facct as "Target Account" host as Host Keywords as Status count as Count

[Logon/Logoff:Logon:4626 - User/Device claims information.]
search = sourcetype="WinEventLog:Security" EventCode="4626"
| TODO

[Logon/Logoff:Logon:4648 - A logon was attempted using explicit credentials.]
search = sourcetype="WinEventLog:Security" EventCode="4648"
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)\s+Logon GUID:\s+(?<Subject_Logon_GUID>.*)" 
| rex field=Message "Account Whose Credentials Were Used:\s+Account Name:\s+(?<AcctCredsUsed_Account_Name>.*)\s+Account Domain:\s+(?<AcctCredsUsed_Account_Domain>.*)\s+Logon GUID:\s+(?<AcctCredsUsed_Logon_GUID>.*)" 
| rex field=Message "Target Server Name:\s+(?<Target_Server_Target_Server_Name>.*)" 
| rex field=Message "Additional Information:\s+(?<Target_Server_AdditionalInfo>.*)" 
| rex field=Message "Process ID:\s+(?<ProcessInfo_Process_ID>.*)" 
| rex field=Message "Process Name:\s+(?<ProcessInfo_Process_Name>.*)" 
| rex field=Message "Network Address:\s+(?<NetInfo_Network_Address>.*)" 
| rex field=Message "Port:\s+(?<NetInfo_Port>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, Subject_Logon_GUID, AcctCredsUsed_Account_Name, AcctCredsUsed_Account_Domain, AcctCredsUsed_Logon_GUID, Target_Server_Target_Server_Name, Target_Server_AdditionalInfo, ProcessInfo_Process_ID, ProcessInfo_Process_Name, NetInfo_Network_Address, NetInfo_Port

[Logon/Logoff:Logon:4675 - SIDs were filtered.]
search = sourcetype="WinEventLog:Security" EventCode="4675"
| TODO

[Logon/Logoff:Network Policy Server:6272 - Network Policy Server granted access to a user.]
search = sourcetype="WinEventLog:Security" EventCode="6272"
| TODO

[Logon/Logoff:Network Policy Server:6273 - Network Policy Server denied access to a user.]
search = sourcetype="WinEventLog:Security" EventCode="6273"
| TODO

[Logon/Logoff:Network Policy Server:6274 - Network Policy Server discarded the request for a user.]
search = sourcetype="WinEventLog:Security" EventCode="6274"
| TODO

[Logon/Logoff:Network Policy Server:6275 - Network Policy Server discarded the accounting request for a user.]
search = sourcetype="WinEventLog:Security" EventCode="6275"
| TODO

[Logon/Logoff:Network Policy Server:6276 - Network Policy Server quarantined a user.]
search = sourcetype="WinEventLog:Security" EventCode="6276"
| TODO

[Logon/Logoff:Network Policy Server:6277 - Network Policy Server granted access to a user but put it on probation because the host did not meet the defined health policy.]
search = sourcetype="WinEventLog:Security" EventCode="6277"
| TODO

[Logon/Logoff:Network Policy Server:6278 - Network Policy Server granted full access to a user because the host met the defined health policy.]
search = sourcetype="WinEventLog:Security" EventCode="6278"
| TODO

[Logon/Logoff:Network Policy Server:6279 - Network Policy Server locked the user account due to repeated failed authentication attempts.]
search = sourcetype="WinEventLog:Security" EventCode="6279"
| TODO

[Logon/Logoff:Network Policy Server:6280 - Network Policy Server unlocked the user account.]
search = sourcetype="WinEventLog:Security" EventCode="6280"
| TODO

[Logon/Logoff:Other Logon/Logoff Events:4649 - A replay attack was detected.]
search = sourcetype="WinEventLog:Security" EventCode="4649"
| TODO

[Logon/Logoff:Other Logon/Logoff Events:4778 - A session was reconnected to a Window Station.]
search = sourcetype="WinEventLog:Security" EventCode="4778"
| TODO

[Logon/Logoff:Other Logon/Logoff Events:4779 - A session was disconnected from a Window Station.]
search = sourcetype="WinEventLog:Security" EventCode="4779"
| TODO

[Logon/Logoff:Other Logon/Logoff Events:4800 - The workstation was locked.]
search = sourcetype="WinEventLog:Security" EventCode="4800"
| TODO

[Logon/Logoff:Other Logon/Logoff Events:4801 - The workstation was unlocked.]
search = sourcetype="WinEventLog:Security" EventCode="4801"
| TODO

[Logon/Logoff:Other Logon/Logoff Events:4802 - The screen saver was invoked.]
search = sourcetype="WinEventLog:Security" EventCode="4802"
| TODO

[Logon/Logoff:Other Logon/Logoff Events:4803 - The screen saver was dismissed.]
search = sourcetype="WinEventLog:Security" EventCode="4803"
| TODO

[Logon/Logoff:Other Logon/Logoff Events:5378 - The requested credentials delegation was disallowed by policy.]
search = sourcetype="WinEventLog:Security" EventCode="5378"
| TODO

[Logon/Logoff:Other Logon/Logoff Events:5632 - A request was made to authenticate to a wireless network.]
search = sourcetype="WinEventLog:Security" EventCode="5632"
| TODO

[Logon/Logoff:Other Logon/Logoff Events:5633 - A request was made to authenticate to a wired network.]
search = sourcetype="WinEventLog:Security" EventCode="5633"
| TODO

[Logon/Logoff:Special Logon:4964 - Special groups have been assigned to a new logon.]
search = sourcetype="WinEventLog:Security" EventCode="4964"
| TODO

[Object Access:Application Generated:4665 - An attempt was made to create an application client context.]
search = sourcetype="WinEventLog:Security" EventCode="4665"
| TODO

[Object Access:Application Generated:4666 - An application attempted an operation:]
search = sourcetype="WinEventLog:Security" EventCode="4666"
| TODO

[Object Access:Application Generated:4667 - An application client context was deleted.]
search = sourcetype="WinEventLog:Security" EventCode="4667"
| TODO

[Object Access:Application Generated:4668 - An application was initialized.]
search = sourcetype="WinEventLog:Security" EventCode="4668"
| TODO

[Object Access:Central Policy Staging:4818 - Proposed Central Access Policy does not grant the same access permissions as the current Central Access Policy]
search = sourcetype="WinEventLog:Security" EventCode="4818"
| TODO

[Object Access:Certification Services:4868 - The certificate manager denied a pending certificate request.]
search = sourcetype="WinEventLog:Security" EventCode="4868"
| TODO

[Object Access:Certification Services:4869 - Certificate Services received a resubmitted certificate request.]
search = sourcetype="WinEventLog:Security" EventCode="4869"
| TODO

[Object Access:Certification Services:4870 - Certificate Services revoked a certificate.]
search = sourcetype="WinEventLog:Security" EventCode="4870"
| TODO

[Object Access:Certification Services:4871 - Certificate Services received a request to publish the certificate revocation list (CRL).]
search = sourcetype="WinEventLog:Security" EventCode="4871"
| TODO

[Object Access:Certification Services:4872 - Certificate Services published the certificate revocation list (CRL).]
search = sourcetype="WinEventLog:Security" EventCode="4872"
| TODO

[Object Access:Certification Services:4873 - A certificate request extension changed.]
search = sourcetype="WinEventLog:Security" EventCode="4873"
| TODO

[Object Access:Certification Services:4874 - One or more certificate request attributes changed.]
search = sourcetype="WinEventLog:Security" EventCode="4874"
| TODO

[Object Access:Certification Services:4875 - Certificate Services received a request to shut down.]
search = sourcetype="WinEventLog:Security" EventCode="4875"
| TODO

[Object Access:Certification Services:4876 - Certificate Services backup started.]
search = sourcetype="WinEventLog:Security" EventCode="4876"
| TODO

[Object Access:Certification Services:4877 - Certificate Services backup completed.]
search = sourcetype="WinEventLog:Security" EventCode="4877"
| TODO

[Object Access:Certification Services:4878 - Certificate Services restore started.]
search = sourcetype="WinEventLog:Security" EventCode="4878"
| TODO

[Object Access:Certification Services:4879 - Certificate Services restore completed.]
search = sourcetype="WinEventLog:Security" EventCode="4879"
| TODO

[Object Access:Certification Services:4880 - Certificate Services started.]
search = sourcetype="WinEventLog:Security" EventCode="4880"
| TODO

[Object Access:Certification Services:4881 - Certificate Services stopped.]
search = sourcetype="WinEventLog:Security" EventCode="4881"
| TODO

[Object Access:Certification Services:4882 - The security permissions for Certificate Services changed.]
search = sourcetype="WinEventLog:Security" EventCode="4882"
| TODO

[Object Access:Certification Services:4883 - Certificate Services retrieved an archived key.]
search = sourcetype="WinEventLog:Security" EventCode="4883"
| TODO

[Object Access:Certification Services:4884 - Certificate Services imported a certificate into its database.]
search = sourcetype="WinEventLog:Security" EventCode="4884"
| TODO

[Object Access:Certification Services:4885 - The audit filter for Certificate Services changed.]
search = sourcetype="WinEventLog:Security" EventCode="4885"
| TODO

[Object Access:Certification Services:4886 - Certificate Services received a certificate request.]
search = sourcetype="WinEventLog:Security" EventCode="4886"
| TODO

[Object Access:Certification Services:4887 - Certificate Services approved a certificate request and issued a certificate.]
search = sourcetype="WinEventLog:Security" EventCode="4887"
| TODO

[Object Access:Certification Services:4888 - Certificate Services denied a certificate request.]
search = sourcetype="WinEventLog:Security" EventCode="4888"
| TODO

[Object Access:Certification Services:4889 - Certificate Services set the status of a certificate request to pending.]
search = sourcetype="WinEventLog:Security" EventCode="4889"
| TODO

[Object Access:Certification Services:4890 - The certificate manager settings for Certificate Services changed.]
search = sourcetype="WinEventLog:Security" EventCode="4890"
| TODO

[Object Access:Certification Services:4891 - A configuration entry changed in Certificate Services.]
search = sourcetype="WinEventLog:Security" EventCode="4891"
| TODO

[Object Access:Certification Services:4892 - A property of Certificate Services changed.]
search = sourcetype="WinEventLog:Security" EventCode="4892"
| TODO

[Object Access:Certification Services:4893 - Certificate Services archived a key.]
search = sourcetype="WinEventLog:Security" EventCode="4893"
| TODO

[Object Access:Certification Services:4894 - Certificate Services imported and archived a key.]
search = sourcetype="WinEventLog:Security" EventCode="4894"
| TODO

[Object Access:Certification Services:4895 - Certificate Services published the CA certificate to Active Directory Domain Services.]
search = sourcetype="WinEventLog:Security" EventCode="4895"
| TODO

[Object Access:Certification Services:4896 - One or more rows have been deleted from the certificate database.]
search = sourcetype="WinEventLog:Security" EventCode="4896"
| TODO

[Object Access:Certification Services:4897 - Role separation enabled:]
search = sourcetype="WinEventLog:Security" EventCode="4897"
| TODO

[Object Access:Certification Services:4898 - Certificate Services loaded a template.]
search = sourcetype="WinEventLog:Security" EventCode="4898"
| TODO

[Object Access:Detailed File Share:5145 - A network share object was checked to see whether the client can be granted desired access.]
search = sourcetype="WinEventLog:Security" EventCode="5145"
| TODO

[Object Access:File Share:5140 - A network share object was accessed.]
search = sourcetype="WinEventLog:Security" EventCode="5140"
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Object Type:\s+(?<NetInfo_Object_Type>.*)" 
| rex field=Message "Source Address:\s+(?<NetInfo_Source_Address>.*)" 
| rex field=Message "Source Port:\s+(?<NetInfo_Source_Port>.*)" 
| rex field=Message "Share Name:\s+(?<Share_Information_Share_Name>.*)" 
| rex field=Message "Share Path:\s+(?<Share_Information_Share_Path>.*)" 
| rex field=Message "Access Mask:\s+(?<AccessReqInfo_Access_Mask>.*)" 
| rex field=Message "Accesses:\s+(?<AccessReqInfo_Accesses>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, NetInfo_Object_Type, NetInfo_Source_Address, NetInfo_Source_Port, Share_Information_Share_Name, Share_Information_Share_Path, AccessReqInfo_Access_Mask, AccessReqInfo_Accesses

[Object Access:File Share:5142 - A network share object was added.]
search = sourcetype="WinEventLog:Security" EventCode="5142"
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Share Name:\s+(?<Share_Information_Share_Name>.*)" 
| rex field=Message "Share Path:\s+(?<Share_Information_Share_Path>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, Share_Information_Share_Name, Share_Information_Share_Path

[Object Access:File Share:5143 - A network share object was modified.]
search = sourcetype="WinEventLog:Security" EventCode="5143"
| TODO

[Object Access:File Share:5144 - A network share object was deleted.]
search = sourcetype="WinEventLog:Security" EventCode="5144"
| TODO

[Object Access:File Share:5168 - Spn check for SMB/SMB2 failed.]
search = sourcetype="WinEventLog:Security" EventCode="5168"
| TODO

[Object Access:File System:4664 - An attempt was made to create a hard link.]
search = sourcetype="WinEventLog:Security" EventCode="4664"
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Account Name:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "File Name:\s+(?<Link_Information_File_Name>.*)" 
| rex field=Message "Link Name:\s+(?<Link_Information_Link_Name>.*)" 
| rex field=Message "Transaction ID:\s+(?<Link_Information_Transaction_ID>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID Subject_Account_Name, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, Link_Information_File_Name, Link_Information_Link_Name, Link_Information_Transaction_ID

[Object Access:File System:4985 - The state of a transaction has changed.]
search = sourcetype="WinEventLog:Security" EventCode="4985"
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "RM Transaction ID:\s+(?<TransactionInfo_RM_TransID>.*)" 
| rex field=Message "New State:\s+(?<TransactionInfo_New_State>.*)" 
| rex field=Message "Resource Manager:\s+(?<TransactionInfo_Resource_Manager>.*)" 
| rex field=Message "Process ID:\s+(?<ProcessInfo_Process_ID>.*)" 
| rex field=Message "Process Name:\s+(?<ProcessInfo_Process_Name>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, TransactionInfo_RM_TransID, TransactionInfo_New_State, TransactionInfo_Resource_Manager, ProcessInfo_Process_ID, ProcessInfo_Process_Name

[Object Access:File System:5051 - A file was virtualized.]
search = sourcetype="WinEventLog:Security" EventCode="5051"
| TODO

[Object Access:Filtering Platform Connection:5031 - The Windows Firewall Service blocked an application from accepting incoming connections on the network.]
search = sourcetype="WinEventLog:Security" EventCode="5031"
| TODO

[Object Access:Filtering Platform Connection:5150 - The Windows Filtering Platform has blocked a packet.]
search = sourcetype="WinEventLog:Security" EventCode="5150"
| TODO

[Object Access:Filtering Platform Connection:5151 - A more restrictive Windows Filtering Platform filter has blocked a packet.]
search = sourcetype="WinEventLog:Security" EventCode="5151"
| TODO

[Object Access:Filtering Platform Connection:5154 - The Windows Filtering Platform has permitted an application or service to listen on a port for incoming connections.]
search = sourcetype="WinEventLog:Security" EventCode="5154"
| TODO

[Object Access:Filtering Platform Connection:5155 - The Windows Filtering Platform has blocked an application or service from listening on a port for incoming connections.]
search = sourcetype="WinEventLog:Security" EventCode="5155"
| TODO

[Object Access:Filtering Platform Connection:5156 - The Windows Filtering Platform has allowed a connection.]
search = sourcetype="WinEventLog:Security" EventCode="5156"
| TODO

[Object Access:Filtering Platform Connection:5157 - The Windows Filtering Platform has blocked a connection.]
search = sourcetype="WinEventLog:Security" EventCode="5157"
| TODO

[Object Access:Filtering Platform Connection:5158 - The Windows Filtering Platform has permitted a bind to a local port.]
search = sourcetype="WinEventLog:Security" EventCode="5158"
| TODO

[Object Access:Filtering Platform Connection:5159 - The Windows Filtering Platform has blocked a bind to a local port.]
search = sourcetype="WinEventLog:Security" EventCode="5159"
| TODO

[Object Access:Filtering Platform Packet Drop :5152 - The Windows Filtering Platform blocked a packet.]
search = sourcetype="WinEventLog:Security" EventCode="5152"
| TODO

[Object Access:Filtering Platform Packet Drop :5153 - A more restrictive Windows Filtering Platform filter has blocked a packet.]
search = sourcetype="WinEventLog:Security" EventCode="5153"
| TODO

[Object Access:Handle Manipulation:4656 - A handle to an object was requested.]
search = sourcetype="WinEventLog:Security" EventCode="4656"
| TODO

[Object Access:Handle Manipulation:4658 - The handle to an object was closed.]
search = sourcetype="WinEventLog:Security" EventCode="4658"
| TODO

[Object Access:Handle Manipulation:4690 - An attempt was made to duplicate a handle to an object.]
search = sourcetype="WinEventLog:Security" EventCode="4690"
| TODO

[Object Access:Other Object Access Events:4671 - An application attempted to access a blocked ordinal through the TBS.]
search = sourcetype="WinEventLog:Security" EventCode="4671"
| TODO

[Object Access:Other Object Access Events:4691 - Indirect access to an object was requested.]
search = sourcetype="WinEventLog:Security" EventCode="4691"
| TODO

[Object Access:Other Object Access Events:4698 - A scheduled task was created.]
search = sourcetype="WinEventLog:Security" EventCode="4698"
| TODO

[Object Access:Other Object Access Events:4699 - A scheduled task was deleted.]
search = sourcetype="WinEventLog:Security" EventCode="4699"
| TODO

[Object Access:Other Object Access Events:4700 - A scheduled task was enabled.]
search = sourcetype="WinEventLog:Security" EventCode="4700"
| TODO

[Object Access:Other Object Access Events:4701 - A scheduled task was disabled.]
search = sourcetype="WinEventLog:Security" EventCode="4701"
| TODO

[Object Access:Other Object Access Events:4702 - A scheduled task was updated.]
search = sourcetype="WinEventLog:Security" EventCode="4702"
| TODO

[Object Access:Other Object Access Events:5148 - The Windows Filtering Platform has detected a DoS attack and entered a defensive mode; packets associated with this attack will be discarded.]
search = sourcetype="WinEventLog:Security" EventCode="5148"
| TODO

[Object Access:Other Object Access Events:5149 - The DoS attack has subsided and normal processing is being resumed.]
search = sourcetype="WinEventLog:Security" EventCode="5149"
| TODO

[Object Access:Other Object Access Events:5888 - An object in the COM+ Catalog was modified.]
search = sourcetype="WinEventLog:Security" EventCode="5888"
| TODO

[Object Access:Other Object Access Events:5889 - An object was deleted from the COM+ Catalog.]
search = sourcetype="WinEventLog:Security" EventCode="5889"
| TODO

[Object Access:Other Object Access Events:5890 - An object was added to the COM+ Catalog.]
search = sourcetype="WinEventLog:Security" EventCode="5890"
| TODO

[Object Access:Registry:4657 - A registry value was modified.]
search = sourcetype="WinEventLog:Security" EventCode="4657"
| TODO

[Object Access:Registry:5039 - A registry key was virtualized.]
search = sourcetype="WinEventLog:Security" EventCode="5039"
| TODO

[Object Access:Special:4659 - A handle to an object was requested with intent to delete.]
search = sourcetype="WinEventLog:Security" EventCode="4659"
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Object Server:\s+(?<Object_Object_Server>.*)" 
| rex field=Message "Object Type:\s+(?<Object_Object_Type>.*)" 
| rex field=Message "Object Name:\s+(?<Object_Object_Name>.*)" 
| rex field=Message "Handle ID:\s+(?<Object_Handle_ID>.*)" 
| rex field=Message "Process ID:\s+(?<ProcessInfo_Process_ID>.*)" 
| rex field=Message "Transaction ID:\s+(?<AccessReqInfo_Transaction_ID>.*)" 
| rex field=Message "Accesses:\s+(?<AccessReqInfo_Accesses>.*)" 
| rex field=Message "Access Mask:\s+(?<AccessReqInfo_Access_Mask>.*)" 
| rex field=Message "Privileges Used for Access Check:\s+(?<AccessReqInfo_PrivsUsed>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, Object_Object_Server, Object_Object_Type, Object_Object_Name, Object_Handle_ID, ProcessInfo_Process_ID, AccessReqInfo_Transaction_ID, AccessReqInfo_Accesses, AccessReqInfo_Access_Mask, AccessReqInfo_PrivsUsed

[Object Access:Special:4660 - An object was deleted.]
search = sourcetype="WinEventLog:Security" EventCode="4660"
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Object Server:\s+(?<Object_Object_Server>.*)" 
| rex field=Message "Handle ID:\s+(?<Object_Handle_ID>.*)" 
| rex field=Message "Process ID:\s+(?<ProcessInfo_Process_ID>.*)" 
| rex field=Message "Process Name:\s+(?<ProcessInfo_Process_Name>.*)" 
| rex field=Message "Transaction ID:\s+(?<ProcessInfo_Transaction_ID>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, Object_Object_Server, Object_Handle_ID, ProcessInfo_Process_ID, ProcessInfo_Process_Name, ProcessInfo_Transaction_ID

[Object Access:Special:4661 - A handle to an object was requested.]
search = sourcetype="WinEventLog:Security" EventCode="4661"
| TODO

[Object Access:Special:4663 - An attempt was made to access an object.]
search = sourcetype="WinEventLog:Security" EventCode="4663"
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Object Server:\s+(?<Object_Object_Server>.*)" 
| rex field=Message "Object Type:\s+(?<Object_Object_Type>.*)" 
| rex field=Message "Object Name:\s+(?<Object_Object_Name>.*)" 
| rex field=Message "Handle ID:\s+(?<Object_Handle_ID>.*)" 
| rex field=Message "Resource Attributes:\s+(?<Object_Resource_Attributes>.*)" 
| rex field=Message "Process ID:\s+(?<ProcessInfo_Process_ID>.*)" 
| rex field=Message "Process Name:\s+(?<ProcessInfo_Process_Name>.*)" 
| rex field=Message "Accesses:\s+(?<AccessReqInfo_Accesses>.*)" 
| rex field=Message "Access Mask:\s+(?<AccessReqInfo_Access_Mask>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, Object_Object_Server, Object_Object_Type, Object_Object_Name, Object_Handle_ID, Object_Resource_Attributes, ProcessInfo_Process_ID, ProcessInfo_Process_Name, AccessReqInfo_Accesses, AccessReqInfo_Access_Mask

[Policy Change:Audit Policy Change:4715 - The audit policy (SACL) on an object was changed.]
search = sourcetype="WinEventLog:Security" EventCode="4715"
| TODO

[Policy Change:Audit Policy Change:4719 - System audit policy was changed.]
search = sourcetype="WinEventLog:Security" EventCode="4719"
| TODO

[Policy Change:Audit Policy Change:4817 - Auditing settings on an object were changed.]
search = sourcetype="WinEventLog:Security" EventCode="4817"
| TODO

[Policy Change:Audit Policy Change:4902 - The Per-user audit policy table was created.]
search = sourcetype="WinEventLog:Security" EventCode="4902"
| rex field=Message "(?<summary>.*)"
| rex field=Message "Number of Elements:\s+(?<Number_Of_Elements>.*)"
| rex field=Message "Policy ID:\s+(?<Policy_ID>.*)"
| table _time host sourcetype EventCode summary Number_Of_Elements Policy_ID

[Policy Change:Audit Policy Change:4904 - An attempt was made to register a security event source.]
search = sourcetype="WinEventLog:Security" EventCode="4904"
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject :\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Process ID:\s+(?<Process_Process_ID>.*)" 
| rex field=Message "Process Name:\s+(?<Process_Process_Name>.*)" 
| rex field=Message "Source Name:\s+(?<Event_Source_Source_Name>.*)" 
| rex field=Message "Event Source ID:\s+(?<Event_Source_Event_Source_ID>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, Process_Process_ID, Process_Process_Name, Event_Source_Source_Name, Event_Source_Event_Source_ID

[Policy Change:Audit Policy Change:4905 - An attempt was made to unregister a security event source.]
search = sourcetype="WinEventLog:Security" EventCode="4905"
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Process ID:\s+(?<Process_Process_ID>.*)" 
| rex field=Message "Process Name:\s+(?<Process_Process_Name>.*)" 
| rex field=Message "Source Name:\s+(?<Event_Source_Source_Name>.*)" 
| rex field=Message "Event Source ID:\s+(?<Event_Source_Event_Source_ID>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, Process_Process_ID, Process_Process_Name, Event_Source_Source_Name, Event_Source_Event_Source_ID

[Policy Change:Audit Policy Change:4906 - The CrashOnAuditFail value has changed.]
search = sourcetype="WinEventLog:Security" EventCode="4906"
| TODO

[Policy Change:Audit Policy Change:4907 - Auditing settings on object were changed.]
search = sourcetype="WinEventLog:Security" EventCode="4907"
| TODO

[Policy Change:Audit Policy Change:4908 - Special Groups Logon table modified.]
search = sourcetype="WinEventLog:Security" EventCode="4908"
| TODO

[Policy Change:Audit Policy Change:4912 - Per User Audit Policy was changed.]
search = sourcetype="WinEventLog:Security" EventCode="4912"
| TODO

[Policy Change:Authentication Policy Change:4713 - Kerberos policy was changed.]
search = sourcetype="WinEventLog:Security" EventCode="4713"
| TODO

[Policy Change:Authentication Policy Change:4716 - Trusted domain information was modified.]
search = sourcetype="WinEventLog:Security" EventCode="4716"
| TODO

[Policy Change:Authentication Policy Change:4717 - System security access was granted to an account.]
search = sourcetype="WinEventLog:Security" EventCode="4717"
| TODO

[Policy Change:Authentication Policy Change:4718 - System security access was removed from an account.]
search = sourcetype="WinEventLog:Security" EventCode="4718"
| TODO

[Policy Change:Authentication Policy Change:4739 - Domain Policy was changed.]
search = sourcetype="WinEventLog:Security" EventCode="4739"
| TODO

[Policy Change:Authentication Policy Change:4864 - A namespace collision was detected.]
search = sourcetype="WinEventLog:Security" EventCode="4864"
| TODO

[Policy Change:Authentication Policy Change:4865 - A trusted forest information entry was added.]
search = sourcetype="WinEventLog:Security" EventCode="4865"
| TODO

[Policy Change:Authentication Policy Change:4866 - A trusted forest information entry was removed.]
search = sourcetype="WinEventLog:Security" EventCode="4866"
| TODO

[Policy Change:Authentication Policy Change:4867 - A trusted forest information entry was modified.]
search = sourcetype="WinEventLog:Security" EventCode="4867"
| TODO

[Policy Change:Authorization Policy Change:4704 - A user right was assigned.]
search = sourcetype="WinEventLog:Security" EventCode="4704"
| TODO

[Policy Change:Authorization Policy Change:4705 - A user right was removed.]
search = sourcetype="WinEventLog:Security" EventCode="4705"
| TODO

[Policy Change:Authorization Policy Change:4706 - A new trust was created to a domain.]
search = sourcetype="WinEventLog:Security" EventCode="4706"
| TODO

[Policy Change:Authorization Policy Change:4707 - A trust to a domain was removed.]
search = sourcetype="WinEventLog:Security" EventCode="4707"
| TODO

[Policy Change:Authorization Policy Change:4714 - Encrypted data recovery policy was changed.]
search = sourcetype="WinEventLog:Security" EventCode="4714"
| TODO

[Policy Change:Authorization Policy Change:4911 - Resource attributes of the object were changed.]
search = sourcetype="WinEventLog:Security" EventCode="4911"
| TODO

[Policy Change:Authorization Policy Change:4913 - Central Access Policy on the object was changed.]
search = sourcetype="WinEventLog:Security" EventCode="4913"
| TODO

[Policy Change:Filtering Platform Policy Change:4709 - IPsec Services was started.]
search = sourcetype="WinEventLog:Security" EventCode="4709"
| TODO

[Policy Change:Filtering Platform Policy Change:4710 - IPsec Services was disabled.]
search = sourcetype="WinEventLog:Security" EventCode="4710"
| TODO

[Policy Change:Filtering Platform Policy Change:4711 - May contain any one of the following: PAStore Engine applied locally cached copy of Active Directory storage IPsec policy on the computer.
PAStore Engine applied Active Directory storage IPsec policy on the computer.
PAStore Engine applied local registry storage IPsec policy on the computer.
PAStore Engine failed to apply locally cached copy of Active Directory storage IPsec policy on the computer.
PAStore Engine failed to apply Active Directory storage IPsec policy on the computer.
PAStore Engine failed to apply local registry storage IPsec policy on the computer.
PAStore Engine failed to apply some rules of the active IPsec policy on the computer.
PAStore Engine failed to load directory storage IPsec policy on the computer.
PAStore Engine loaded directory storage IPsec policy on the computer.
PAStore Engine failed to load local storage IPsec policy on the computer.
PAStore Engine loaded local storage IPsec policy on the computer.
PAStore Engine polled for changes to the active IPsec policy and detected no changes.]
search = sourcetype="WinEventLog:Security" EventCode="4711"
| TODO

[Policy Change:Filtering Platform Policy Change:4712 - IPsec Services encountered a potentially serious failure.]
search = sourcetype="WinEventLog:Security" EventCode="4712"
| TODO

[Policy Change:Filtering Platform Policy Change:5040 - A change has been made to IPsec settings. An Authentication Set was added.]
search = sourcetype="WinEventLog:Security" EventCode="5040"
| TODO

[Policy Change:Filtering Platform Policy Change:5041 - A change has been made to IPsec settings. An Authentication Set was modified.]
search = sourcetype="WinEventLog:Security" EventCode="5041"
| TODO

[Policy Change:Filtering Platform Policy Change:5042 - A change has been made to IPsec settings. An Authentication Set was deleted.]
search = sourcetype="WinEventLog:Security" EventCode="5042"
| TODO

[Policy Change:Filtering Platform Policy Change:5043 - A change has been made to IPsec settings. A Connection Security Rule was added.]
search = sourcetype="WinEventLog:Security" EventCode="5043"
| TODO

[Policy Change:Filtering Platform Policy Change:5044 - A change has been made to IPsec settings. A Connection Security Rule was modified.]
search = sourcetype="WinEventLog:Security" EventCode="5044"
| TODO

[Policy Change:Filtering Platform Policy Change:5045 - A change has been made to IPsec settings. A Connection Security Rule was deleted.]
search = sourcetype="WinEventLog:Security" EventCode="5045"
| TODO

[Policy Change:Filtering Platform Policy Change:5046 - A change has been made to IPsec settings. A Crypto Set was added.]
search = sourcetype="WinEventLog:Security" EventCode="5046"
| TODO

[Policy Change:Filtering Platform Policy Change:5047 - A change has been made to IPsec settings. A Crypto Set was modified.]
search = sourcetype="WinEventLog:Security" EventCode="5047"
| TODO

[Policy Change:Filtering Platform Policy Change:5048 - A change has been made to IPsec settings. A Crypto Set was deleted.]
search = sourcetype="WinEventLog:Security" EventCode="5048"
| TODO

[Policy Change:Filtering Platform Policy Change:5440 - The following callout was present when the Windows Filtering Platform Base Filtering Engine started.]
search = sourcetype="WinEventLog:Security" EventCode="5440"
| TODO

[Policy Change:Filtering Platform Policy Change:5441 - The following filter was present when the Windows Filtering Platform Base Filtering Engine started.]
search = sourcetype="WinEventLog:Security" EventCode="5441"
| TODO

[Policy Change:Filtering Platform Policy Change:5442 - The following provider was present when the Windows Filtering Platform Base Filtering Engine started.]
search = sourcetype="WinEventLog:Security" EventCode="5442"
| TODO

[Policy Change:Filtering Platform Policy Change:5443 - The following provider context was present when the Windows Filtering Platform Base Filtering Engine started.]
search = sourcetype="WinEventLog:Security" EventCode="5443"
| TODO

[Policy Change:Filtering Platform Policy Change:5444 - The following sub-layer was present when the Windows Filtering Platform Base Filtering Engine started.]
search = sourcetype="WinEventLog:Security" EventCode="5444"
| TODO

[Policy Change:Filtering Platform Policy Change:5446 - A Windows Filtering Platform callout has been changed.]
search = sourcetype="WinEventLog:Security" EventCode="5446"
| TODO

[Policy Change:Filtering Platform Policy Change:5448 - A Windows Filtering Platform provider has been changed.]
search = sourcetype="WinEventLog:Security" EventCode="5448"
| TODO

[Policy Change:Filtering Platform Policy Change:5449 - A Windows Filtering Platform provider context has been changed.]
search = sourcetype="WinEventLog:Security" EventCode="5449"
| TODO

[Policy Change:Filtering Platform Policy Change:5450 - A Windows Filtering Platform sub-layer has been changed.]
search = sourcetype="WinEventLog:Security" EventCode="5450"
| TODO

[Policy Change:Filtering Platform Policy Change:5456 - PAStore Engine applied Active Directory storage IPsec policy on the computer.]
search = sourcetype="WinEventLog:Security" EventCode="5456"
| TODO

[Policy Change:Filtering Platform Policy Change:5457 - PAStore Engine failed to apply Active Directory storage IPsec policy on the computer.]
search = sourcetype="WinEventLog:Security" EventCode="5457"
| TODO

[Policy Change:Filtering Platform Policy Change:5458 - PAStore Engine applied locally cached copy of Active Directory storage IPsec policy on the computer.]
search = sourcetype="WinEventLog:Security" EventCode="5458"
| TODO

[Policy Change:Filtering Platform Policy Change:5459 - PAStore Engine failed to apply locally cached copy of Active Directory storage IPsec policy on the computer.]
search = sourcetype="WinEventLog:Security" EventCode="5459"
| TODO

[Policy Change:Filtering Platform Policy Change:5460 - PAStore Engine applied local registry storage IPsec policy on the computer.]
search = sourcetype="WinEventLog:Security" EventCode="5460"
| TODO

[Policy Change:Filtering Platform Policy Change:5461 - PAStore Engine failed to apply local registry storage IPsec policy on the computer.]
search = sourcetype="WinEventLog:Security" EventCode="5461"
| TODO

[Policy Change:Filtering Platform Policy Change:5462 - PAStore Engine failed to apply some rules of the active IPsec policy on the computer. Use the IP Security Monitor snap-in to diagnose the problem.]
search = sourcetype="WinEventLog:Security" EventCode="5462"
| TODO

[Policy Change:Filtering Platform Policy Change:5463 - PAStore Engine polled for changes to the active IPsec policy and detected no changes.]
search = sourcetype="WinEventLog:Security" EventCode="5463"
| TODO

[Policy Change:Filtering Platform Policy Change:5464 - PAStore Engine polled for changes to the active IPsec policy, detected changes, and applied them to IPsec Services.]
search = sourcetype="WinEventLog:Security" EventCode="5464"
| TODO

[Policy Change:Filtering Platform Policy Change:5465 - PAStore Engine received a control for forced reloading of IPsec policy and processed the control successfully.]
search = sourcetype="WinEventLog:Security" EventCode="5465"
| TODO

[Policy Change:Filtering Platform Policy Change:5466 - PAStore Engine polled for changes to the Active Directory IPsec policy, determined that Active Directory cannot be reached, and will use the cached copy of the Active Directory IPsec policy instead. Any changes made to the Active Directory IPsec policy since the last poll could not be applied.]
search = sourcetype="WinEventLog:Security" EventCode="5466"
| TODO

[Policy Change:Filtering Platform Policy Change:5467 - PAStore Engine polled for changes to the Active Directory IPsec policy, determined that Active Directory can be reached, and found no changes to the policy. The cached copy of the Active Directory IPsec policy is no longer being used.]
search = sourcetype="WinEventLog:Security" EventCode="5467"
| TODO

[Policy Change:Filtering Platform Policy Change:5468 - PAStore Engine polled for changes to the Active Directory IPsec policy, determined that Active Directory can be reached, found changes to the policy, and applied those changes. The cached copy of the Active Directory IPsec policy is no longer being used.]
search = sourcetype="WinEventLog:Security" EventCode="5468"
| TODO

[Policy Change:Filtering Platform Policy Change:5471 - PAStore Engine loaded local storage IPsec policy on the computer.]
search = sourcetype="WinEventLog:Security" EventCode="5471"
| TODO

[Policy Change:Filtering Platform Policy Change:5472 - PAStore Engine failed to load local storage IPsec policy on the computer.]
search = sourcetype="WinEventLog:Security" EventCode="5472"
| TODO

[Policy Change:Filtering Platform Policy Change:5473 - PAStore Engine loaded directory storage IPsec policy on the computer.]
search = sourcetype="WinEventLog:Security" EventCode="5473"
| TODO

[Policy Change:Filtering Platform Policy Change:5474 - PAStore Engine failed to load directory storage IPsec policy on the computer.]
search = sourcetype="WinEventLog:Security" EventCode="5474"
| TODO

[Policy Change:Filtering Platform Policy Change:5477 - PAStore Engine failed to add quick mode filter.]
search = sourcetype="WinEventLog:Security" EventCode="5477"
| TODO

[Policy Change:MPSSVC Rule-Level Policy Change:4944 - The following policy was active when the Windows Firewall started.]
search = sourcetype="WinEventLog:Security" EventCode="4944"
| TODO

[Policy Change:MPSSVC Rule-Level Policy Change:4945 - A rule was listed when the Windows Firewall started.]
search = sourcetype="WinEventLog:Security" EventCode="4945"
| TODO

[Policy Change:MPSSVC Rule-Level Policy Change:4946 - A change has been made to Windows Firewall exception list. A rule was added.]
search = sourcetype="WinEventLog:Security" EventCode="4946"
| TODO

[Policy Change:MPSSVC Rule-Level Policy Change:4947 - A change has been made to Windows Firewall exception list. A rule was modified.]
search = sourcetype="WinEventLog:Security" EventCode="4947"
| TODO

[Policy Change:MPSSVC Rule-Level Policy Change:4948 - A change has been made to Windows Firewall exception list. A rule was deleted.]
search = sourcetype="WinEventLog:Security" EventCode="4948"
| TODO

[Policy Change:MPSSVC Rule-Level Policy Change:4949 - Windows Firewall settings were restored to the default values.]
search = sourcetype="WinEventLog:Security" EventCode="4949"
| TODO

[Policy Change:MPSSVC Rule-Level Policy Change:4950 - A Windows Firewall setting has changed.]
search = sourcetype="WinEventLog:Security" EventCode="4950"
| TODO

[Policy Change:MPSSVC Rule-Level Policy Change:4951 - A rule has been ignored because its major version number was not recognized by Windows Firewall.]
search = sourcetype="WinEventLog:Security" EventCode="4951"
| TODO

[Policy Change:MPSSVC Rule-Level Policy Change:4952 - Parts of a rule have been ignored because its minor version number was not recognized by Windows Firewall. The other parts of the rule will be enforced.]
search = sourcetype="WinEventLog:Security" EventCode="4952"
| TODO

[Policy Change:MPSSVC Rule-Level Policy Change:4953 - A rule has been ignored by Windows Firewall because it could not parse the rule.]
search = sourcetype="WinEventLog:Security" EventCode="4953"
| TODO

[Policy Change:MPSSVC Rule-Level Policy Change:4954 - Windows Firewall Group Policy settings have changed. The new settings have been applied.]
search = sourcetype="WinEventLog:Security" EventCode="4954"
| TODO

[Policy Change:MPSSVC Rule-Level Policy Change:4956 - Windows Firewall has changed the active profile.]
search = sourcetype="WinEventLog:Security" EventCode="4956"
| TODO

[Policy Change:MPSSVC Rule-Level Policy Change:4957 - Windows Firewall did not apply the following rule:]
search = sourcetype="WinEventLog:Security" EventCode="4957"
| TODO

[Policy Change:MPSSVC Rule-Level Policy Change:4958 - Windows Firewall did not apply the following rule because the rule referred to items not configured on this computer:]
search = sourcetype="WinEventLog:Security" EventCode="4958"
| TODO

[Policy Change:Other Policy Change Events:4819 - Central Access Policies on the machine have been changed.]
search = sourcetype="WinEventLog:Security" EventCode="4819"
| TODO

[Policy Change:Other Policy Change Events:4909 - The local policy settings for the TBS were changed.]
search = sourcetype="WinEventLog:Security" EventCode="4909"
| TODO

[Policy Change:Other Policy Change Events:4910 - The group policy settings for the TBS were changed.]
search = sourcetype="WinEventLog:Security" EventCode="4910"
| TODO

[Policy Change:Other Policy Change Events:5063 - A cryptographic provider operation was attempted.]
search = sourcetype="WinEventLog:Security" EventCode="5063"
| TODO

[Policy Change:Other Policy Change Events:5064 - A cryptographic context operation was attempted.]
search = sourcetype="WinEventLog:Security" EventCode="5064"
| TODO

[Policy Change:Other Policy Change Events:5065 - A cryptographic context modification was attempted.]
search = sourcetype="WinEventLog:Security" EventCode="5065"
| TODO

[Policy Change:Other Policy Change Events:5066 - A cryptographic function operation was attempted.]
search = sourcetype="WinEventLog:Security" EventCode="5066"
| TODO

[Policy Change:Other Policy Change Events:5067 - A cryptographic function modification was attempted.]
search = sourcetype="WinEventLog:Security" EventCode="5067"
| TODO

[Policy Change:Other Policy Change Events:5068 - A cryptographic function provider operation was attempted.]
search = sourcetype="WinEventLog:Security" EventCode="5068"
| TODO

[Policy Change:Other Policy Change Events:5069 - A cryptographic function property operation was attempted.]
search = sourcetype="WinEventLog:Security" EventCode="5069"
| TODO

[Policy Change:Other Policy Change Events:5070 - A cryptographic function property modification was attempted.]
search = sourcetype="WinEventLog:Security" EventCode="5070"
| TODO

[Policy Change:Other Policy Change Events:5447 - A Windows Filtering Platform filter has been changed.]
search = sourcetype="WinEventLog:Security" EventCode="5447"
| TODO

[Policy Change:Other Policy Change Events:6144 - Security policy in the group policy objects has been applied successfully.]
search = sourcetype="WinEventLog:Security" EventCode="6144"
| TODO

[Policy Change:Other Policy Change Events:6145 - One or more errors occurred while processing security policy in the group policy objects.]
search = sourcetype="WinEventLog:Security" EventCode="6145"
| TODO

[Policy Change:Subcategory (special):4670 - Permissions on an object were changed.]
search = sourcetype="WinEventLog:Security" EventCode="4670"
| TODO

[Privilege Use:Sensitive Privilege Use / Non Sensitive Privilege Use:4672 - Special privileges assigned to new logon.]
search = sourcetype="WinEventLog:Security" EventCode="4672"
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| table _time host sourcetype EventCode summary Subject_Security_ID Subject_Account_Name Subject_Account_Domain Subject_Logon_ID privilege_id

[Privilege Use:Sensitive Privilege Use / Non Sensitive Privilege Use:4673 - A privileged service was called.]
search = sourcetype="WinEventLog:Security" EventCode="4673"
| TODO

[Privilege Use:Sensitive Privilege Use / Non Sensitive Privilege Use:4674 - An operation was attempted on a privileged object.]
search = sourcetype="WinEventLog:Security" EventCode="4674"
| TODO

[System:IPsec Driver:4960 - IPsec dropped an inbound packet that failed an integrity check. If this problem persists, it could indicate a network issue or that packets are being modified in transit to this computer. Verify that the packets sent from the remote computer are the same as those received by this computer. This error might also indicate interoperability problems with other IPsec implementations.]
search = sourcetype="WinEventLog:Security" EventCode="4960"
| TODO

[System:IPsec Driver:4961 - IPsec dropped an inbound packet that failed a replay check. If this problem persists, it could indicate a replay attack against this computer.]
search = sourcetype="WinEventLog:Security" EventCode="4961"
| TODO

[System:IPsec Driver:4962 - IPsec dropped an inbound packet that failed a replay check. The inbound packet had too low a sequence number to ensure it was not a replay.]
search = sourcetype="WinEventLog:Security" EventCode="4962"
| TODO

[System:IPsec Driver:4963 - IPsec dropped an inbound clear text packet that should have been secured. This is usually due to the remote computer changing its IPsec policy without informing this computer. This could also be a spoofing attack attempt.]
search = sourcetype="WinEventLog:Security" EventCode="4963"
| TODO

[System:IPsec Driver:4965 - IPsec received a packet from a remote computer with an incorrect Security Parameter Index (SPI). This is usually caused by malfunctioning hardware that is corrupting packets. If these errors persist, verify that the packets sent from the remote computer are the same as those received by this computer. This error may also indicate interoperability problems with other IPsec implementations. In that case, if connectivity is not impeded, then these events can be ignored.]
search = sourcetype="WinEventLog:Security" EventCode="4965"
| TODO

[System:IPsec Driver:5478 - IPsec Services has started successfully.]
search = sourcetype="WinEventLog:Security" EventCode="5478"
| TODO

[System:IPsec Driver:5479 - IPsec Services has been shut down successfully. The shutdown of IPsec Services can put the computer at greater risk of network attack or expose the computer to potential security risks.]
search = sourcetype="WinEventLog:Security" EventCode="5479"
| TODO

[System:IPsec Driver:5480 - IPsec Services failed to get the complete list of network interfaces on the computer. This poses a potential security risk because some of the network interfaces may not get the protection provided by the applied IPsec filters. Use the IP Security Monitor snap-in to diagnose the problem.]
search = sourcetype="WinEventLog:Security" EventCode="5480"
| TODO

[System:IPsec Driver:5483 - IPsec Services failed to initialize RPC server. IPsec Services could not be started.]
search = sourcetype="WinEventLog:Security" EventCode="5483"
| TODO

[System:IPsec Driver:5484 - IPsec Services has experienced a critical failure and has been shut down. The shutdown of IPsec Services can put the computer at greater risk of network attack or expose the computer to potential security risks.]
search = sourcetype="WinEventLog:Security" EventCode="5484"
| TODO

[System:IPsec Driver:5485 - IPsec Services failed to process some IPsec filters on a plug-and-play event for network interfaces. This poses a potential security risk because some of the network interfaces may not get the protection provided by the applied IPsec filters. Use the IP Security Monitor snap-in to diagnose the problem.]
search = sourcetype="WinEventLog:Security" EventCode="5485"
| TODO

[System:Other System Events:5024 - The Windows Firewall Service has started successfully.]
search = sourcetype="WinEventLog:Security" EventCode="5024"
| rex field=Message "(?<summary>.*)"
| table _time host sourcetype EventCode summary

[System:Other System Events:5025 - The Windows Firewall Service has been stopped.]
search = sourcetype="WinEventLog:Security" EventCode="5025"
| TODO

[System:Other System Events:5027 - The Windows Firewall Service was unable to retrieve the security policy from the local storage. The service will continue enforcing the current policy.]
search = sourcetype="WinEventLog:Security" EventCode="5027"
| TODO

[System:Other System Events:5028 - The Windows Firewall Service was unable to parse the new security policy. The service will continue with currently enforced policy.]
search = sourcetype="WinEventLog:Security" EventCode="5028"
| TODO

[System:Other System Events:5029 - The Windows Firewall Service failed to initialize the driver. The service will continue to enforce the current policy.]
search = sourcetype="WinEventLog:Security" EventCode="5029"
| TODO

[System:Other System Events:5030 - The Windows Firewall Service failed to start.]
search = sourcetype="WinEventLog:Security" EventCode="5030"
| TODO

[System:Other System Events:5032 - Windows Firewall was unable to notify the user that it blocked an application from accepting incoming connections on the network.]
search = sourcetype="WinEventLog:Security" EventCode="5032"
| TODO

[System:Other System Events:5033 - The Windows Firewall Driver has started successfully.]
search = sourcetype="WinEventLog:Security" EventCode="5033"
| rex field=Message "(?<summary>.*)"
| table _time host sourcetype EventCode summary

[System:Other System Events:5034 - The Windows Firewall Driver has been stopped.]
search = sourcetype="WinEventLog:Security" EventCode="5034"
| TODO

[System:Other System Events:5035 - The Windows Firewall Driver failed to start.]
search = sourcetype="WinEventLog:Security" EventCode="5035"
| TODO

[System:Other System Events:5037 - The Windows Firewall Driver detected critical runtime error. Terminating.]
search = sourcetype="WinEventLog:Security" EventCode="5037"
| TODO

[System:Other System Events:5058 - Key file operation.]
search = sourcetype="WinEventLog:Security" EventCode="5058"
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Provider Name:\s+(?<CryptoParams_Provider_Name>.*)" 
| rex field=Message "Algorithm Name:\s+(?<CryptoParams_Algorithm_Name>.*)" 
| rex field=Message "Key Name:\s+(?<CryptoParams_Key_Name>.*)" 
| rex field=Message "Key Type:\s+(?<CryptoParams_Key_Type>.*)" 
| rex field=Message "File Path:\s+(?<KeyFileOpInfo_File_Path>.*)" 
| rex field=Message "Operation:\s+(?<KeyFileOpInfo_Operation>.*)" 
| rex field=Message "Return Code:\s+(?<KeyFileOpInfo_Return_Code>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, CryptoParams_Provider_Name, CryptoParams_Algorithm_Name, CryptoParams_Key_Name, CryptoParams_Key_Type, KeyFileOpInfo_File_Path, KeyFileOpInfo_Operation, KeyFileOpInfo_Return_Code

[System:Other System Events:5059 - Key migration operation.]
search = sourcetype="WinEventLog:Security" EventCode="5059"
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Provider Name:\s+(?<CryptoParams_Provider_Name>.*)" 
| rex field=Message "Algorithm Name:\s+(?<CryptoParams_Algorithm_Name>.*)" 
| rex field=Message "Key Name:\s+(?<CryptoParams_Key_Name>.*)" 
| rex field=Message "Key Type:\s+(?<CryptoParams_Key_Type>.*)" 
| rex field=Message "Operation:\s+(?<AddtlInfo_Operation>.*)" 
| rex field=Message "Return Code:\s+(?<AddtlInfo_Return_Code>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, CryptoParams_Provider_Name, CryptoParams_Algorithm_Name, CryptoParams_Key_Name, CryptoParams_Key_Type, AddtlInfo_Operation, AddtlInfo_Return_Code

[System:Other System Events:6400 - BranchCache: Received an incorrectly formatted response while discovering availability of content. ]
search = sourcetype="WinEventLog:Security" EventCode="6400"
| TODO

[System:Other System Events:6401 - BranchCache: Received invalid data from a peer. Data discarded. ]
search = sourcetype="WinEventLog:Security" EventCode="6401"
| TODO

[System:Other System Events:6402 - BranchCache: The message to the hosted cache offering it data is incorrectly formatted. ]
search = sourcetype="WinEventLog:Security" EventCode="6402"
| TODO

[System:Other System Events:6403 - BranchCache: The hosted cache sent an incorrectly formatted response to the client.]
search = sourcetype="WinEventLog:Security" EventCode="6403"
| TODO

[System:Other System Events:6404 - BranchCache: Hosted cache could not be authenticated using the provisioned SSL certificate. ]
search = sourcetype="WinEventLog:Security" EventCode="6404"
| TODO

[System:Other System Events:6405 - BranchCache: %2 instance(s) of event id %1 occurred.]
search = sourcetype="WinEventLog:Security" EventCode="6405"
| TODO

[System:Other System Events:6406 - %1 registered to Windows Firewall to control filtering for the following: %2]
search = sourcetype="WinEventLog:Security" EventCode="6406"
| TODO

[System:Other System Events:6407 - 1%]
search = sourcetype="WinEventLog:Security" EventCode="6407"
| TODO

[System:Other System Events:6408 - Registered product %1 failed and Windows Firewall is now controlling the filtering for %2]
search = sourcetype="WinEventLog:Security" EventCode="6408"
| TODO

[System:Security State Change:4608 - Windows is starting up.]
search = sourcetype="WinEventLog:Security" EventCode="4608"
| rex field=Message "(?<summary>.*)"
| table _time host sourcetype EventCode summary

[System:Security State Change:4609 - Windows is shutting down.]
search = sourcetype="WinEventLog:Security" EventCode="4609"
| TODO

[System:Security State Change:4616 - The system time was changed.]
search = sourcetype="WinEventLog:Security" EventCode="4616"
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Process ID:\s+(?<ProcessInfo_Process_ID>.*)" 
| rex field=Message "Name:\s+(?<ProcessInfo_Name>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, ProcessInfo_Process_ID, ProcessInfo_Name

[System:Security State Change:4621 - Administrator recovered system from CrashOnAuditFail. Users who are not administrators will now be allowed to log on. Some auditable activity might not have been recorded.]
search = sourcetype="WinEventLog:Security" EventCode="4621"
| TODO

[System:Security System Extension:4610 - An authentication package has been loaded by the Local Security Authority.]
search = sourcetype="WinEventLog:Security" EventCode="4610"
| TODO

[System:Security System Extension:4611 - A trusted logon process has been registered with the Local Security Authority.]
search = sourcetype="WinEventLog:Security" EventCode="4611"
| TODO

[System:Security System Extension:4614 - A notification package has been loaded by the Security Account Manager.]
search = sourcetype="WinEventLog:Security" EventCode="4614"
| TODO

[System:Security System Extension:4622 - A security package has been loaded by the Local Security Authority.]
search = sourcetype="WinEventLog:Security" EventCode="4622"
| TODO

[System:Security System Extension:4697 - A service was installed in the system.]
search = sourcetype="WinEventLog:Security" EventCode="4697"
| TODO

[System:System Integrity:4612 - Internal resources allocated for the queuing of audit messages have been exhausted, leading to the loss of some audits.]
search = sourcetype="WinEventLog:Security" EventCode="4612"
| TODO

[System:System Integrity:4615 - Invalid use of LPC port.]
search = sourcetype="WinEventLog:Security" EventCode="4615"
| TODO

[System:System Integrity:4618 - A monitored security event pattern has occurred.]
search = sourcetype="WinEventLog:Security" EventCode="4618"
| TODO

[System:System Integrity:4816 - RPC detected an integrity violation while decrypting an incoming message.]
search = sourcetype="WinEventLog:Security" EventCode="4816"
| TODO

[System:System Integrity:5038 - Code integrity determined that the image hash of a file is not valid. The file could be corrupt due to unauthorized modification or the invalid hash could indicate a potential disk device error.]
search = sourcetype="WinEventLog:Security" EventCode="5038"
| TODO

[System:System Integrity:5056 - A cryptographic self test was performed.]
search = sourcetype="WinEventLog:Security" EventCode="5056"
| TODO

[System:System Integrity:5057 - A cryptographic primitive operation failed.]
search = sourcetype="WinEventLog:Security" EventCode="5057"
| TODO

[System:System Integrity:5060 - Verification operation failed.]
search = sourcetype="WinEventLog:Security" EventCode="5060"
| TODO

[System:System Integrity:5061 - Cryptographic operation.]
search = sourcetype="WinEventLog:Security" EventCode="5061"
| rex field=Message "(?<summary>.*)" 
| rex field=Message "Subject:\s+Security ID:\s+(?<Subject_Security_ID>.*)\s+Account Name:\s+(?<Subject_Account_Name>.*)\s+Account Domain:\s+(?<Subject_Account_Domain>.*)\s+Logon ID:\s+(?<Subject_Logon_ID>.*)"
| rex field=Message "Provider Name:\s+(?<CryptoParams_Provider_Name>.*)" 
| rex field=Message "Algorithm Name:\s+(?<CryptoParams_Algorithm_Name>.*)" 
| rex field=Message "Key Name:\s+(?<CryptoParams_Key_Name>.*)" 
| rex field=Message "Key Type:\s+(?<CryptoParams_Key_Type>.*)" 
| rex field=Message "Operation:\s+(?<CryptoOp_Operation>.*)" 
| rex field=Message "Return Code:\s+(?<CryptoOp_Return_Code>.*)"
| table _time host sourcetype EventCode summary, Subject_Security_ID, Subject_Account_Name, Subject_Account_Domain, Subject_Logon_ID, CryptoParams_Provider_Name, CryptoParams_Algorithm_Name, CryptoParams_Key_Name, CryptoParams_Key_Type, CryptoOp_Operation, CryptoOp_Return_Code

[System:System Integrity:5062 - A kernel-mode cryptographic self test was performed.]
search = sourcetype="WinEventLog:Security" EventCode="5062"
| TODO

[System:System Integrity:6281 - Code Integrity determined that the page hashes of an image file are not valid. The file could be improperly signed without page hashes or corrupt due to unauthorized modification. The invalid hashes could indicate a potential disk device error]
search = sourcetype="WinEventLog:Security" EventCode="6281"
| TODO
